Package                  Version
------------------------ -----------
aiohappyeyeballs         2.4.3
aiohttp                  3.10.10
aiosignal                1.3.1
async-timeout            4.0.3
attrs                    24.2.0
blosc2                   2.5.1
certifi                  2024.8.30
charset-normalizer       3.4.0
click                    8.1.7
click-plugins            1.1.1
cligj                    0.7.2
contourpy                1.3.0
cycler                   0.12.1
filelock                 3.16.1
fiona                    1.10.1
fonttools                4.54.1
frozenlist               1.5.0
fsspec                   2024.10.0
geopandas                0.14.4
idna                     3.10
importlib-metadata       8.5.0
importlib-resources      6.4.5
jinja2                   3.1.4
joblib                   1.4.2
kiwisolver               1.4.7
MarkupSafe               3.0.2
matplotlib               3.9.2
mpmath                   1.3.0
msgpack                  1.1.0
multidict                6.1.0
ndindex                  1.9.2
networkx                 3.2.1
numexpr                  2.10.1
numpy                    1.26.4
nvidia-cublas-cu12       12.4.5.8
nvidia-cuda-cupti-cu12   12.4.127
nvidia-cuda-nvrtc-cu12   12.4.127
nvidia-cuda-runtime-cu12 12.4.127
nvidia-cudnn-cu12        9.1.0.70
nvidia-cufft-cu12        11.2.1.3
nvidia-curand-cu12       10.3.5.147
nvidia-cusolver-cu12     11.6.1.9
nvidia-cusparse-cu12     12.3.1.170
nvidia-nccl-cu12         2.21.5
nvidia-nvjitlink-cu12    12.4.127
nvidia-nvtx-cu12         12.4.127
osmnx                    1.9.4
packaging                24.1
pandas                   2.2.3
pillow                   11.0.0
pip                      20.2.3
propcache                0.2.0
psutil                   6.1.0
py-cpuinfo               9.0.0
pyparsing                3.2.0
pyproj                   3.6.1
python-dateutil          2.9.0.post0
pytz                     2024.2
requests                 2.32.3
scikit-learn             1.5.2
scipy                    1.13.1
setuptools               49.2.1
shapely                  2.0.6
six                      1.16.0
sympy                    1.13.1
tables                   3.9.2
threadpoolctl            3.5.0
torch                    2.5.0
torch-geometric          2.6.1
torchaudio               2.5.0
torchvision              0.20.0
tqdm                     4.66.5
triton                   3.1.0
typing-extensions        4.12.2
tzdata                   2024.2
urllib3                  2.2.3
yarl                     1.16.0
zipp                     3.20.2
/g/data/hn98/matt/forecasting-on-new-roads
Thu Oct 31 08:16:34 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-SXM2-32GB           On  |   00000000:B1:00.0 Off |                    0 |
| N/A   32C    P0             41W /  300W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Architecture:        x86_64
CPU op-mode(s):      32-bit, 64-bit
Byte Order:          Little Endian
CPU(s):              96
On-line CPU(s) list: 0-95
Thread(s) per core:  2
Core(s) per socket:  24
Socket(s):           2
NUMA node(s):        4
Vendor ID:           GenuineIntel
CPU family:          6
Model:               85
Model name:          Intel(R) Xeon(R) Platinum 8268 CPU @ 2.90GHz
Stepping:            7
CPU MHz:             2900.000
CPU max MHz:         3900.0000
CPU min MHz:         1200.0000
BogoMIPS:            5800.00
L1d cache:           32K
L1i cache:           32K
L2 cache:            1024K
L3 cache:            36608K
NUMA node0 CPU(s):   0-3,7-9,13-15,19,20,48-51,55-57,61-63,67,68
NUMA node1 CPU(s):   4-6,10-12,16-18,21-23,52-54,58-60,64-66,69-71
NUMA node2 CPU(s):   24-27,31-33,37-39,43,44,72-75,79-81,85-87,91,92
NUMA node3 CPU(s):   28-30,34-36,40-42,45-47,76-78,82-84,88-90,93-95
Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 cdp_l3 invpcid_single intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm mpx rdt_a avx512f avx512dq rdseed adx smap clflushopt clwb intel_pt avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local dtherm ida arat pln pts hwp hwp_act_window hwp_epp hwp_pkg_req pku ospke avx512_vnni md_clear flush_l1d arch_capabilities
sys.argv ['./pred_GWN_16_adpAdj.py', '1', '0.7', '0', '2', '100', 'METRLA', '2', '1', '0.0', '1', '1', '2', '207', '0.01', '50', '100', '0', '0.0003', '0']
P.DATANAME == METRLA
data.shape (34272, 207)
pred_METRLA_GraphWaveNet_2410310819_3169031 data splits Thu Oct 31 08:19:56 2024
spatialSplit_unseen all: trn/val/tst : 207 : 144 / 20 / 41
[194 181 143  10  13 118 119  23 175  28  44 101  25 171  24 179 185 109
  65 191  53 176  35  41 142   6  12  29  18 113   5 126   2 114   3 186
  14 122 147 180  84 111  54 204  85 154 146  94   9  66  71  45  64 134
 139 106 152  48  42 131 144 184  57 127 115  91  89 153 112 174  11   8
 182 172 140 135  98 133 197 128 158  78 166 155 173  99  90  79   1  82
 200 199 156 187 195 108  36  92 178 120  62   0  27 100 164 189 203  20
 165 183 163 149  77  30 161  17  59 188  74 141 159 169  93 130  21 123
  55 157  16 206 151  87  97 125  61  81  68 129  56  19  86  70 137  60]
[135  20  36  18 199  78  77 113  15  87 172 188  32 100 186  59 110  72
  75  80]
[  4   0  54  42  37  80 205  67 180 126  57  88 204 149 152 140 109 201
  55 116 143   1  30 203  71  86  39  49  59  47 161  84  26 130 163 128
 153 141 127  74 169]
spatialSplit_allNod all: trn/val/tst : 207 : 144 / 165 / 207
[194 181 143  10  13 118 119  23 175  28  44 101  25 171  24 179 185 109
  65 191  53 176  35  41 142   6  12  29  18 113   5 126   2 114   3 186
  14 122 147 180  84 111  54 204  85 154 146  94   9  66  71  45  64 134
 139 106 152  48  42 131 144 184  57 127 115  91  89 153 112 174  11   8
 182 172 140 135  98 133 197 128 158  78 166 155 173  99  90  79   1  82
 200 199 156 187 195 108  36  92 178 120  62   0  27 100 164 189 203  20
 165 183 163 149  77  30 161  17  59 188  74 141 159 169  93 130  21 123
  55 157  16 206 151  87  97 125  61  81  68 129  56  19  86  70 137  60]
[135  20  36  18 199  78  77 113  15  87 172 188  32 100 186  59 110  72
  75  80 187 150 178 141 174  96  67 194 154 183  61 200 125 107 101  53
 137   2  25 120 121  38  48 159  24  62 132   7  55 167  52  46 116   9
  71  16  28  69 161 158  51 182 145 173 119   0  22 129  56 124 102 170
  70  37  84  88 201  30 168  68 131 139  79  40  17  73 123 160  89  21
 103 176  41 169  29 133  14  34  86  65 165 146  94 190 114   5  64  93
   3 143 117  43  42 177  10 205  50 142 198  66  44  58 109  83 155  12
 180  13 140 206 153 136  95 202 204 108  49 191  35 193  99 157 138 112
 163 128 184  31  97 147 196 181  98 118  76  47 192 144  60 115  27 151
  11   8 189]
[  4   0  54  42  37  80 205  67 180 126  57  88 204 149 152 140 109 201
  55 116 143   1  30 203  71  86  39  49  59  47 161  84  26 130 163 128
 153 141 127  74 169 156  22 171 147  87  75  82   8 170  56 123 142  32
  68  18  99 181 166  34  14  16  19  81 192  63  10  95  70 165 199 196
  13 197 115  61  40 194  65  72 182 108  48 124 164  78  77  29 111   2
 138 176 119   3  64  93 113 177  51 118  89  62 134  45 101 107 151  33
 129 157 183 189  69 193 162 120  31 175 114 158 172 185  97  11 105  17
 135  60 195 106  44 178 187 131  58  79  85   5 184 168  53 136 206 146
  35 200 145 102 122  66 104  52 121  46 117  28  21   9 174 186 103  20
 137 110  76 179 155 112 148 144 202  73   6   7 190 191 198  43 167 159
  92 154  50  24  38  27 150  41  90  94 133 125  23  12 132  96 160  36
 173 100  25  91  83  15 139 188  98]
train.shape torch.Size([23969, 2, 144, 12]) torch.Size([23969, 12, 144, 1])
val_u.shape torch.Size([3425, 2, 20, 12]) torch.Size([3425, 12, 20, 1])
val_a.shape torch.Size([3425, 2, 165, 12]) torch.Size([3425, 12, 165, 1])
tst_u.shape torch.Size([6844, 2, 41, 12]) torch.Size([6844, 12, 41, 1])
tst_a.shape torch.Size([6844, 2, 207, 12]) torch.Size([6844, 12, 207, 1])
adj_train 2 torch.Size([144, 144]) torch.Size([144, 144])
adj_val_u 2 torch.Size([20, 20]) torch.Size([20, 20])
adj_val_a 2 torch.Size([165, 165]) torch.Size([165, 165])
adj_tst_u 2 torch.Size([41, 41]) torch.Size([41, 41])
adj_tst_a 2 torch.Size([207, 207]) torch.Size([207, 207])
TIMESTEP_IN 12
TIMESTEP_OUT 12
CHANNEL 2
BATCHSIZE 64
LEARN 0.001
PRETRN_EPOCH 50
EPOCH 100
TRAINRATIO 0.8
TRAINVALSPLIT 0.125
ADJTYPE doubletransition
MODELNAME GraphWaveNet
FEATURES 2
SUBGRAPH_SIZE 207
QUOTIENT_GRAPH_RADIUS 0.01
NETWORK_CALLS False
PRE_LEARN 0.0003
GRAPH_NORM False
IS_PRETRN True
R_TRN 0.7
IS_EPOCH_1 False
seed 2
TEMPERATURE 100.0
DATANAME METRLA
seed_SS 2
IS_DESEASONED True
weight_decay 0.0
adp_adj True
is_SGA True
KEYWORD pred_METRLA_GraphWaveNet_2410310819_3169031
PATH ../save/pred_METRLA_GraphWaveNet_2410310819_3169031
FLOWPATH ../METRLA/metr-la.h5
n_dct_coeff 3918
ADJPATH ../METRLA/adj_mx.pkl
N_NODE 207
trainval_size 27394
train_size 23969
pred_METRLA_GraphWaveNet_2410310819_3169031 pretraining started Thu Oct 31 08:20:01 2024
pretrainModel Started ... Thu Oct 31 08:20:01 2024
epoch 0 time used: 12  seconds  train loss: 6.0120610892772675 validation loss: 6.010461330413818
epoch 1 time used: 6  seconds  train loss: 6.0088116973638535 validation loss: 6.010014533996582
epoch 2 time used: 5  seconds  train loss: 6.008648410439491 validation loss: 6.009939670562744
epoch 3 time used: 6  seconds  train loss: 6.008636176586151 validation loss: 6.009744167327881
epoch 4 time used: 4  seconds  train loss: 6.0086192935705185 validation loss: 6.0097479820251465
epoch 5 time used: 4  seconds  train loss: 6.008628629148006 validation loss: 6.0098443031311035
epoch 6 time used: 4  seconds  train loss: 6.00862081348896 validation loss: 6.010595321655273
epoch 7 time used: 4  seconds  train loss: 6.008611984550953 validation loss: 6.010072708129883
epoch 8 time used: 4  seconds  train loss: 6.008607484400272 validation loss: 6.0106120109558105
epoch 9 time used: 4  seconds  train loss: 6.008617676794529 validation loss: 6.01021146774292
epoch 10 time used: 4  seconds  train loss: 6.008605003356934 validation loss: 6.009850025177002
epoch 11 time used: 4  seconds  train loss: 6.008602142333984 validation loss: 6.010373592376709
epoch 12 time used: 5  seconds  train loss: 6.00859434902668 validation loss: 6.009720802307129
epoch 13 time used: 4  seconds  train loss: 6.008597619831562 validation loss: 6.010169982910156
epoch 14 time used: 4  seconds  train loss: 6.008591525256634 validation loss: 6.010159015655518
epoch 15 time used: 4  seconds  train loss: 6.008595354855061 validation loss: 6.010014533996582
epoch 16 time used: 4  seconds  train loss: 6.008594699203968 validation loss: 6.010567665100098
epoch 17 time used: 4  seconds  train loss: 6.008590616285801 validation loss: 6.010217189788818
epoch 18 time used: 4  seconds  train loss: 6.00859197974205 validation loss: 6.0103373527526855
epoch 19 time used: 4  seconds  train loss: 6.008590094745159 validation loss: 6.010130167007446
epoch 20 time used: 4  seconds  train loss: 6.00859072804451 validation loss: 6.009839057922363
epoch 21 time used: 4  seconds  train loss: 6.008590169250965 validation loss: 6.010401725769043
epoch 22 time used: 4  seconds  train loss: 6.008588798344135 validation loss: 6.010377407073975
epoch 23 time used: 4  seconds  train loss: 6.008588641881943 validation loss: 6.010454177856445
epoch 24 time used: 4  seconds  train loss: 6.008589364588261 validation loss: 6.01009464263916
epoch 25 time used: 4  seconds  train loss: 6.008587785065174 validation loss: 6.010430335998535
epoch 26 time used: 4  seconds  train loss: 6.008590757846832 validation loss: 6.010125160217285
epoch 27 time used: 4  seconds  train loss: 6.008589923381805 validation loss: 6.010217666625977
epoch 28 time used: 4  seconds  train loss: 6.0085868537425995 validation loss: 6.010469436645508
epoch 29 time used: 4  seconds  train loss: 6.008588455617428 validation loss: 6.009886741638184
epoch 30 time used: 4  seconds  train loss: 6.008586347103119 validation loss: 6.009894847869873
epoch 31 time used: 4  seconds  train loss: 6.008585840463638 validation loss: 6.009793758392334
epoch 32 time used: 4  seconds  train loss: 6.0085892379283905 validation loss: 6.010172367095947
epoch 33 time used: 4  seconds  train loss: 6.008585877716541 validation loss: 6.009880542755127
epoch 34 time used: 4  seconds  train loss: 6.008586250245571 validation loss: 6.009853363037109
epoch 35 time used: 4  seconds  train loss: 6.008587256073952 validation loss: 6.010318756103516
epoch 36 time used: 4  seconds  train loss: 6.008586689829826 validation loss: 6.01010799407959
epoch 37 time used: 4  seconds  train loss: 6.008585527539253 validation loss: 6.010532379150391
epoch 38 time used: 4  seconds  train loss: 6.008585251867771 validation loss: 6.0101518630981445
epoch 39 time used: 4  seconds  train loss: 6.008583754301071 validation loss: 6.010227680206299
epoch 40 time used: 4  seconds  train loss: 6.008585497736931 validation loss: 6.010119438171387
epoch 41 time used: 4  seconds  train loss: 6.0085867792367935 validation loss: 6.0101752281188965
epoch 42 time used: 4  seconds  train loss: 6.008583910763264 validation loss: 6.010476589202881
epoch 43 time used: 4  seconds  train loss: 6.008583523333073 validation loss: 6.010470390319824
epoch 44 time used: 4  seconds  train loss: 6.008583217859268 validation loss: 6.010316848754883
epoch 45 time used: 4  seconds  train loss: 6.008582018315792 validation loss: 6.010172367095947
epoch 46 time used: 4  seconds  train loss: 6.008582815527916 validation loss: 6.01047420501709
epoch 47 time used: 4  seconds  train loss: 6.008582040667534 validation loss: 6.010078430175781
epoch 48 time used: 4  seconds  train loss: 6.008581653237343 validation loss: 6.01005744934082
epoch 49 time used: 4  seconds  train loss: 6.008582353591919 validation loss: 6.010476589202881
PRETIME DURATION: 2024-10-31 08:24:26.217955 - 2024-10-31 08:20:01.483672 = 0:04:24.734283
pretrainModel Ended ... Thu Oct 31 08:24:26 2024
pred_METRLA_GraphWaveNet_2410310819_3169031 training started Thu Oct 31 08:24:26 2024
trainModel Started ... Thu Oct 31 08:24:26 2024
TIMESTEP_IN, TIMESTEP_OUT 12 12
Model Training Started ... 2024-10-31 08:24:26.262839
train_embed torch.Size([32, 144]) tensor(0.2324, device='cuda:0') tensor(0.3788, device='cuda:0')
val_u_embed torch.Size([32, 20]) tensor(0.1772, device='cuda:0') tensor(0.2576, device='cuda:0')
val_a_embed torch.Size([32, 165]) tensor(0.2229, device='cuda:0') tensor(0.3576, device='cuda:0')
epoch 0 time used: 30  seconds  train loss: 0.24680129177935198 validation unseen nodes loss: 0.2518405332486995 validation all nodes loss: 0.23176067488471958
epoch 1 time used: 27  seconds  train loss: 0.2212582030205162 validation unseen nodes loss: 0.2513139617269057 validation all nodes loss: 0.22964399990809226
epoch 2 time used: 27  seconds  train loss: 0.21673175588550433 validation unseen nodes loss: 0.24955380769541663 validation all nodes loss: 0.22416879273244064
epoch 3 time used: 26  seconds  train loss: 0.21274683115936807 validation unseen nodes loss: 0.2982862353020341 validation all nodes loss: 0.22456825480408912
epoch 4 time used: 26  seconds  train loss: 0.20939362933076294 validation unseen nodes loss: 0.37655462719228144 validation all nodes loss: 0.22552759453763058
epoch 5 time used: 26  seconds  train loss: 0.2066102105895849 validation unseen nodes loss: 0.34519691511662337 validation all nodes loss: 0.2315270769683114
epoch 6 time used: 26  seconds  train loss: 0.20361994776679415 validation unseen nodes loss: 0.3003959340988284 validation all nodes loss: 0.22743056743684475
epoch 7 time used: 26  seconds  train loss: 0.2014746542867231 validation unseen nodes loss: 0.3254528967742502 validation all nodes loss: 0.23472339183744723
epoch 8 time used: 26  seconds  train loss: 0.1989011877244025 validation unseen nodes loss: 0.36604048637578085 validation all nodes loss: 0.22978537070925217
epoch 9 time used: 26  seconds  train loss: 0.19760559876999403 validation unseen nodes loss: 0.31404849037636806 validation all nodes loss: 0.23642364059051457
epoch 10 time used: 26  seconds  train loss: 0.19587181812669274 validation unseen nodes loss: 0.2991462999973854 validation all nodes loss: 0.23562313522300582
epoch 11 time used: 26  seconds  train loss: 0.19617776844691381 validation unseen nodes loss: 0.3506976416076187 validation all nodes loss: 0.23964550666565443
epoch 12 time used: 26  seconds  train loss: 0.19274714233390958 validation unseen nodes loss: 0.3238646618380164 validation all nodes loss: 0.23463628455235142
epoch 13 time used: 26  seconds  train loss: 0.19387372414332377 validation unseen nodes loss: 0.3284419098213641 validation all nodes loss: 0.23327897600883984
epoch 14 time used: 26  seconds  train loss: 0.19189445061562602 validation unseen nodes loss: 0.3354413836193781 validation all nodes loss: 0.23365449083112452
epoch 15 time used: 26  seconds  train loss: 0.19149417898508617 validation unseen nodes loss: 0.2847253635634471 validation all nodes loss: 0.23373425693407546
epoch 16 time used: 26  seconds  train loss: 0.19031961180350226 validation unseen nodes loss: 0.27339348075598696 validation all nodes loss: 0.23344392350990406
epoch 17 time used: 26  seconds  train loss: 0.19056978546472458 validation unseen nodes loss: 0.3813009953411826 validation all nodes loss: 0.23544442859879375
epoch 18 time used: 26  seconds  train loss: 0.18958578848949217 validation unseen nodes loss: 0.4229499773735548 validation all nodes loss: 0.23792408311889118
epoch 19 time used: 26  seconds  train loss: 0.18793168805784863 validation unseen nodes loss: 0.3531395876059567 validation all nodes loss: 0.23640239140413102
epoch 20 time used: 26  seconds  train loss: 0.18721540402727493 validation unseen nodes loss: 0.3922143685556676 validation all nodes loss: 0.2456042309834139
epoch 21 time used: 26  seconds  train loss: 0.18552007254576314 validation unseen nodes loss: 0.3668063193081069 validation all nodes loss: 0.24462219475394617
epoch 22 time used: 26  seconds  train loss: 0.18424905822221266 validation unseen nodes loss: 0.45017274716474714 validation all nodes loss: 0.24418603891438811
epoch 23 time used: 26  seconds  train loss: 0.18408742212382329 validation unseen nodes loss: 0.3139841976609543 validation all nodes loss: 0.25588651748469277
epoch 24 time used: 26  seconds  train loss: 0.1843746312245782 validation unseen nodes loss: 0.2835877719108206 validation all nodes loss: 0.24721660249424676
epoch 25 time used: 26  seconds  train loss: 0.18363400823760925 validation unseen nodes loss: 0.27501883150017176 validation all nodes loss: 0.2483657802804543
epoch 26 time used: 26  seconds  train loss: 0.1829261995882767 validation unseen nodes loss: 0.2883891887864927 validation all nodes loss: 0.24501025319969566
epoch 27 time used: 26  seconds  train loss: 0.1821075732051528 validation unseen nodes loss: 0.2856313295869062 validation all nodes loss: 0.25023457843456826
epoch 28 time used: 26  seconds  train loss: 0.18188424228022915 validation unseen nodes loss: 0.28191627239223815 validation all nodes loss: 0.24559134636917254
epoch 29 time used: 26  seconds  train loss: 0.18176943115024952 validation unseen nodes loss: 0.2908767767413689 validation all nodes loss: 0.250806776145949
epoch 30 time used: 26  seconds  train loss: 0.18169675909911862 validation unseen nodes loss: 0.2937783532160042 validation all nodes loss: 0.24462955148985785
epoch 31 time used: 26  seconds  train loss: 0.18055083451006865 validation unseen nodes loss: 0.29510466368964117 validation all nodes loss: 0.2537426500468358
epoch 32 time used: 26  seconds  train loss: 0.17882625072183644 validation unseen nodes loss: 0.2754810369971895 validation all nodes loss: 0.24966230494262528
epoch 33 time used: 26  seconds  train loss: 0.18058913065659657 validation unseen nodes loss: 0.28914930515045667 validation all nodes loss: 0.24748782406758218
epoch 34 time used: 26  seconds  train loss: 0.18061261195290784 validation unseen nodes loss: 0.2932080363835732 validation all nodes loss: 0.2476603146321582
epoch 35 time used: 26  seconds  train loss: 0.1788130135215703 validation unseen nodes loss: 0.3129513745368832 validation all nodes loss: 0.25166360324751724
epoch 36 time used: 26  seconds  train loss: 0.17827973401804104 validation unseen nodes loss: 0.3047858580185549 validation all nodes loss: 0.25301856963738906
epoch 37 time used: 26  seconds  train loss: 0.1778841747589665 validation unseen nodes loss: 0.2950045439405163 validation all nodes loss: 0.25036561550450154
epoch 38 time used: 26  seconds  train loss: 0.17734942626913835 validation unseen nodes loss: 0.32096736067838044 validation all nodes loss: 0.2543858428810635
epoch 39 time used: 26  seconds  train loss: 0.17726179507165754 validation unseen nodes loss: 0.32035047787384396 validation all nodes loss: 0.25313221383268814
epoch 40 time used: 26  seconds  train loss: 0.1778236501128062 validation unseen nodes loss: 0.39919474969815166 validation all nodes loss: 0.25209845947088116
epoch 41 time used: 26  seconds  train loss: 0.17708422666278567 validation unseen nodes loss: 0.298130399249766 validation all nodes loss: 0.26023924536948656
epoch 42 time used: 26  seconds  train loss: 0.1772603930973769 validation unseen nodes loss: 0.2958269465448212 validation all nodes loss: 0.26415075193356424
epoch 43 time used: 27  seconds  train loss: 0.17534685929089933 validation unseen nodes loss: 0.29954830440291524 validation all nodes loss: 0.25762996241994146
epoch 44 time used: 26  seconds  train loss: 0.17379146697034406 validation unseen nodes loss: 0.3084824501162898 validation all nodes loss: 0.25386191889317367
epoch 45 time used: 26  seconds  train loss: 0.1743068956921966 validation unseen nodes loss: 0.31898998533722256 validation all nodes loss: 0.25444614161540124
epoch 46 time used: 26  seconds  train loss: 0.1731699129903892 validation unseen nodes loss: 0.5376814156466156 validation all nodes loss: 0.25669488558368964
epoch 47 time used: 26  seconds  train loss: 0.17443916011045124 validation unseen nodes loss: 0.3445448470115662 validation all nodes loss: 0.2487642261364164
epoch 48 time used: 26  seconds  train loss: 0.17389938080359063 validation unseen nodes loss: 0.33316185904245305 validation all nodes loss: 0.2531186191922557
epoch 49 time used: 26  seconds  train loss: 0.1713878776424444 validation unseen nodes loss: 0.40872198984570746 validation all nodes loss: 0.2704500175349034
epoch 50 time used: 26  seconds  train loss: 0.17062637087047372 validation unseen nodes loss: 0.3028102736011909 validation all nodes loss: 0.34944120888292357
epoch 51 time used: 26  seconds  train loss: 0.17321276231854812 validation unseen nodes loss: 0.40019018535196343 validation all nodes loss: 0.27341606529524726
epoch 52 time used: 26  seconds  train loss: 0.17256638265527918 validation unseen nodes loss: 0.37276410133299165 validation all nodes loss: 0.24555949069722727
epoch 53 time used: 26  seconds  train loss: 0.1710866124073243 validation unseen nodes loss: 0.7589747374075173 validation all nodes loss: 0.2561444165845857
epoch 54 time used: 26  seconds  train loss: 0.16890182864000036 validation unseen nodes loss: 0.42273812167835934 validation all nodes loss: 0.254678616915306
epoch 55 time used: 26  seconds  train loss: 0.16917161883786244 validation unseen nodes loss: 0.8207429324449413 validation all nodes loss: 0.253928821182599
epoch 56 time used: 26  seconds  train loss: 0.16905093645765015 validation unseen nodes loss: 0.5317217032578739 validation all nodes loss: 0.2910674468835775
epoch 57 time used: 26  seconds  train loss: 0.16701942846639678 validation unseen nodes loss: 0.5139516153474794 validation all nodes loss: 0.2620705597113519
epoch 58 time used: 26  seconds  train loss: 0.16871604380706479 validation unseen nodes loss: 0.5194652238466444 validation all nodes loss: 0.2968430297435635
epoch 59 time used: 26  seconds  train loss: 0.16931516956681728 validation unseen nodes loss: 0.3412453552928284 validation all nodes loss: 0.25882121371091715
epoch 60 time used: 26  seconds  train loss: 0.166206211988109 validation unseen nodes loss: 0.44846256122101835 validation all nodes loss: 0.2566034199808636
epoch 61 time used: 26  seconds  train loss: 0.16544052606117562 validation unseen nodes loss: 0.7360196669606397 validation all nodes loss: 0.26021778827601105
epoch 62 time used: 26  seconds  train loss: 0.17086388969708358 validation unseen nodes loss: 0.36694565841751375 validation all nodes loss: 0.263247776518773
epoch 63 time used: 26  seconds  train loss: 0.16575700012242184 validation unseen nodes loss: 0.4277653731742915 validation all nodes loss: 0.2616894727988835
epoch 64 time used: 26  seconds  train loss: 0.16397696933284203 validation unseen nodes loss: 0.4225808010571194 validation all nodes loss: 0.25848171958523075
epoch 65 time used: 26  seconds  train loss: 0.1665489374577932 validation unseen nodes loss: 0.3628370514359787 validation all nodes loss: 0.26035971793380097
epoch 66 time used: 26  seconds  train loss: 0.16957528157953655 validation unseen nodes loss: 0.36133241787008996 validation all nodes loss: 0.36535917036724785
epoch 67 time used: 26  seconds  train loss: 0.16382274560817137 validation unseen nodes loss: 0.3694705979667441 validation all nodes loss: 0.2706517091458731
epoch 68 time used: 26  seconds  train loss: 0.16286000399796882 validation unseen nodes loss: 0.40269471066711593 validation all nodes loss: 0.35218766321230977
epoch 69 time used: 26  seconds  train loss: 0.1618198020879276 validation unseen nodes loss: 0.4413686976380592 validation all nodes loss: 0.30110341568932913
epoch 70 time used: 26  seconds  train loss: 0.1611309690978581 validation unseen nodes loss: 0.4561717273458077 validation all nodes loss: 0.3249360947756872
epoch 71 time used: 26  seconds  train loss: 0.1618332988906799 validation unseen nodes loss: 0.36169542201679117 validation all nodes loss: 0.6581657461745896
epoch 72 time used: 26  seconds  train loss: 0.16275462556319997 validation unseen nodes loss: 0.4121242907534551 validation all nodes loss: 0.28396095295892143
epoch 73 time used: 26  seconds  train loss: 0.160760099498723 validation unseen nodes loss: 0.5125427424298585 validation all nodes loss: 0.29644002211790016
epoch 74 time used: 26  seconds  train loss: 0.16183534569749547 validation unseen nodes loss: 0.46844017159329715 validation all nodes loss: 0.29133639942555534
epoch 75 time used: 26  seconds  train loss: 0.16080709432321186 validation unseen nodes loss: 0.3566139565158064 validation all nodes loss: 0.3773851345098802
epoch 76 time used: 26  seconds  train loss: 0.1634726034937944 validation unseen nodes loss: 0.3782318251585438 validation all nodes loss: 0.2552881767018868
epoch 77 time used: 26  seconds  train loss: 0.16371085162621635 validation unseen nodes loss: 0.45806639082240364 validation all nodes loss: 0.3119442129352667
epoch 78 time used: 26  seconds  train loss: 0.16071582135691045 validation unseen nodes loss: 0.4974828980873971 validation all nodes loss: 0.2633540029943424
epoch 79 time used: 26  seconds  train loss: 0.1599063922889023 validation unseen nodes loss: 0.4597723535899698 validation all nodes loss: 0.2672528481352938
epoch 80 time used: 26  seconds  train loss: 0.16192505824197354 validation unseen nodes loss: 0.36282422752275956 validation all nodes loss: 0.2663624419043534
epoch 81 time used: 26  seconds  train loss: 0.1689366950644207 validation unseen nodes loss: 0.5803617324011169 validation all nodes loss: 0.26314125458254434
epoch 82 time used: 26  seconds  train loss: 0.15925614329036222 validation unseen nodes loss: 0.6307171183345962 validation all nodes loss: 0.2649668319904021
epoch 83 time used: 26  seconds  train loss: 0.15860044775172683 validation unseen nodes loss: 0.6709435003430304 validation all nodes loss: 0.2712039076803374
epoch 84 time used: 26  seconds  train loss: 0.15810818008643635 validation unseen nodes loss: 0.7300235439913116 validation all nodes loss: 0.2919224205808918
epoch 85 time used: 26  seconds  train loss: 0.16038223933087375 validation unseen nodes loss: 0.598239540949355 validation all nodes loss: 0.26413783084737125
epoch 86 time used: 27  seconds  train loss: 0.16074142971394023 validation unseen nodes loss: 0.5790685495320897 validation all nodes loss: 0.2683982369238443
epoch 87 time used: 27  seconds  train loss: 0.16064061140097985 validation unseen nodes loss: 1.1837555221223484 validation all nodes loss: 0.2735886846841687
epoch 88 time used: 27  seconds  train loss: 0.15724234469071752 validation unseen nodes loss: 0.9868838696758242 validation all nodes loss: 0.2722441091154614
epoch 89 time used: 27  seconds  train loss: 0.15729571218743055 validation unseen nodes loss: 1.0434526071583268 validation all nodes loss: 0.27205323601291126
epoch 90 time used: 26  seconds  train loss: 0.15768191307774423 validation unseen nodes loss: 0.9668818720935906 validation all nodes loss: 0.28114369943629214
epoch 91 time used: 26  seconds  train loss: 0.15822801929617053 validation unseen nodes loss: 0.8799755733030555 validation all nodes loss: 0.2791067654634044
epoch 92 time used: 26  seconds  train loss: 0.16531817794699083 validation unseen nodes loss: 0.43951584072878763 validation all nodes loss: 0.25942670974418197
epoch 93 time used: 26  seconds  train loss: 0.16610787810449323 validation unseen nodes loss: 0.7440312937402377 validation all nodes loss: 0.26694595099365626
epoch 94 time used: 26  seconds  train loss: 0.15839305730187114 validation unseen nodes loss: 0.7365402945984889 validation all nodes loss: 0.26753679427352267
epoch 95 time used: 26  seconds  train loss: 0.15977758214370674 validation unseen nodes loss: 0.730373194583141 validation all nodes loss: 0.5125976957239374
epoch 96 time used: 26  seconds  train loss: 0.15912892602266282 validation unseen nodes loss: 1.1573781149230735 validation all nodes loss: 0.2661609090940796
epoch 97 time used: 26  seconds  train loss: 0.15575464822206148 validation unseen nodes loss: 0.9715183785013909 validation all nodes loss: 0.27351559065989334
epoch 98 time used: 26  seconds  train loss: 0.15549680232539176 validation unseen nodes loss: 1.0013511145027885 validation all nodes loss: 0.26680138586211377
epoch 99 time used: 26  seconds  train loss: 0.15503903839365255 validation unseen nodes loss: 0.8911969649704703 validation all nodes loss: 0.27333283243823225
MODEL TRAINING DURATION: 2024-10-31 09:09:29.628365 - 2024-10-31 08:24:26.262839 = 0:45:03.365526
****************************************
GraphWaveNet, train, MAE on train, 1.5328256167e-01, 0.1532825617
min_val_u_loss 0.24955380769541663
min_val_a_loss 0.22416879273244064
trainModel Ended ... Thu Oct 31 09:09:38 2024
pred_METRLA_GraphWaveNet_2410310819_3169031 testing started Thu Oct 31 09:09:38 2024
Model Testing test_u Started ... Thu Oct 31 09:09:38 2024
TIMESTEP_IN, TIMESTEP_OUT 12 12
Model Infer Start ... 2024-10-31 09:09:38.595945
Model Infer End ... 2024-10-31 09:09:46.426392
MODEL INFER DURATION: 2024-10-31 09:09:46.426392 - 2024-10-31 09:09:38.595945 = 0:00:07.830447
YS.shape, YS_pred.shape, (6844, 12, 41, 1) (6844, 12, 41, 1)
YS.shape, YS_pred.shape, (6844, 12, 41) (6844, 12, 41)
****************************************
GraphWaveNet, test_u, Torch MSE, 2.5450797172e-01, 0.2545079717
all pred steps, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 112.4969482422, 10.6064577103, 4.6909604073, 11.0610708594
1 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 33.9974136353, 5.8307299614, 2.8228068352, 6.2147621065
2 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 52.0174903870, 7.2123150826, 3.3047146797, 7.4853152037
3 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 66.7961502075, 8.1728916168, 3.6624813080, 8.4363222122
4 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 82.4197692871, 9.0785331726, 4.0156188011, 9.3226738274
5 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 97.0183792114, 9.8497905731, 4.3326144218, 10.1470448077
6 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 111.2898330688, 10.5493993759, 4.6637988091, 10.9702095389
7 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 122.9503631592, 11.0882987976, 4.9331107140, 11.6688311100
8 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 135.8791351318, 11.6567201614, 5.2302436829, 12.4270893633
9 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 147.0427856445, 12.1261196136, 5.4866709709, 13.0956605077
10 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 158.3205413818, 12.5825490952, 5.7403593063, 13.7395903468
11 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 165.2876586914, 12.8564243317, 5.9203510284, 14.2797455192
12 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 176.9591827393, 13.3026008606, 6.1791019440, 14.9465456605
Model Testing Ended ... Thu Oct 31 09:09:48 2024
Model Testing test_a Started ... Thu Oct 31 09:09:48 2024
TIMESTEP_IN, TIMESTEP_OUT 12 12
Model Infer Start ... 2024-10-31 09:09:48.517162
Model Infer End ... 2024-10-31 09:09:58.705415
MODEL INFER DURATION: 2024-10-31 09:09:58.705415 - 2024-10-31 09:09:48.517162 = 0:00:10.188253
YS.shape, YS_pred.shape, (6844, 12, 207, 1) (6844, 12, 207, 1)
YS.shape, YS_pred.shape, (6844, 12, 207) (6844, 12, 207)
****************************************
GraphWaveNet, test_a, Torch MSE, 2.6339934172e-01, 0.2633993417
all pred steps, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 113.4085998535, 10.6493473053, 4.8057093620, 13.5836124420
1 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 33.0271072388, 5.7469215393, 2.7905509472, 6.6718772054
2 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 50.1022758484, 7.0782961845, 3.3064255714, 8.4461711347
3 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 65.0830841064, 8.0674085617, 3.6965479851, 9.7211681306
4 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 80.5643081665, 8.9757623672, 4.0627889633, 11.0228344798
5 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 96.1328125000, 9.8047342300, 4.4335355759, 12.2398383915
6 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 110.4056549072, 10.5074090958, 4.7667980194, 13.3780568838
7 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 124.4390106201, 11.1552238464, 5.0875892639, 14.4747778773
8 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 138.6477966309, 11.7748794556, 5.4235067368, 15.7030403614
9 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 149.0790252686, 12.2097921371, 5.6575603485, 16.5409371257
10 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 161.4753112793, 12.7072935104, 5.9373879433, 17.5351008773
11 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 170.7969818115, 13.0689315796, 6.1463084221, 18.3218434453
12 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 181.1601257324, 13.4595737457, 6.3597192764, 18.9485281706
Model Testing Ended ... Thu Oct 31 09:10:06 2024
SCRIPT DURATION 0:50:16.054568

======================================================================================
                  Resource Usage on 2024-10-31 09:10:22:
   Job Id:             127921456.gadi-pbs
   Project:            hn98
   Exit Status:        0
   Service Units:      32.62
   NCPUs Requested:    12                     NCPUs Used: 12              
                                           CPU Time Used: 00:49:53        
   Memory Requested:   8.0GB                 Memory Used: 5.25GB          
   NGPUs Requested:    1                 GPU Utilisation: 47%             
                                         GPU Memory Used: 2.32GB          
   Walltime requested: 03:00:00            Walltime Used: 00:54:22        
   JobFS requested:    100.0MB                JobFS used: 17.52KB         
======================================================================================
