Package                  Version
------------------------ -----------
aiohappyeyeballs         2.4.3
aiohttp                  3.10.10
aiosignal                1.3.1
async-timeout            4.0.3
attrs                    24.2.0
blosc2                   2.5.1
certifi                  2024.8.30
charset-normalizer       3.4.0
click                    8.1.7
click-plugins            1.1.1
cligj                    0.7.2
contourpy                1.3.0
cycler                   0.12.1
filelock                 3.16.1
fiona                    1.10.1
fonttools                4.54.1
frozenlist               1.5.0
fsspec                   2024.10.0
geopandas                0.14.4
idna                     3.10
importlib-metadata       8.5.0
importlib-resources      6.4.5
jinja2                   3.1.4
joblib                   1.4.2
kiwisolver               1.4.7
MarkupSafe               3.0.2
matplotlib               3.9.2
mpmath                   1.3.0
msgpack                  1.1.0
multidict                6.1.0
ndindex                  1.9.2
networkx                 3.2.1
numexpr                  2.10.1
numpy                    1.26.4
nvidia-cublas-cu12       12.4.5.8
nvidia-cuda-cupti-cu12   12.4.127
nvidia-cuda-nvrtc-cu12   12.4.127
nvidia-cuda-runtime-cu12 12.4.127
nvidia-cudnn-cu12        9.1.0.70
nvidia-cufft-cu12        11.2.1.3
nvidia-curand-cu12       10.3.5.147
nvidia-cusolver-cu12     11.6.1.9
nvidia-cusparse-cu12     12.3.1.170
nvidia-nccl-cu12         2.21.5
nvidia-nvjitlink-cu12    12.4.127
nvidia-nvtx-cu12         12.4.127
osmnx                    1.9.4
packaging                24.1
pandas                   2.2.3
pillow                   11.0.0
pip                      20.2.3
propcache                0.2.0
psutil                   6.1.0
py-cpuinfo               9.0.0
pyparsing                3.2.0
pyproj                   3.6.1
python-dateutil          2.9.0.post0
pytz                     2024.2
requests                 2.32.3
scikit-learn             1.5.2
scipy                    1.13.1
setuptools               49.2.1
shapely                  2.0.6
six                      1.16.0
sympy                    1.13.1
tables                   3.9.2
threadpoolctl            3.5.0
torch                    2.5.0
torch-geometric          2.6.1
torchaudio               2.5.0
torchvision              0.20.0
tqdm                     4.66.5
triton                   3.1.0
typing-extensions        4.12.2
tzdata                   2024.2
urllib3                  2.2.3
yarl                     1.16.0
zipp                     3.20.2
/g/data/hn98/matt/forecasting-on-new-roads
Thu Oct 31 08:20:04 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-SXM2-32GB           On  |   00000000:B1:00.0 Off |                    0 |
| N/A   32C    P0             41W /  300W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Architecture:        x86_64
CPU op-mode(s):      32-bit, 64-bit
Byte Order:          Little Endian
CPU(s):              96
On-line CPU(s) list: 0-95
Thread(s) per core:  2
Core(s) per socket:  24
Socket(s):           2
NUMA node(s):        4
Vendor ID:           GenuineIntel
CPU family:          6
Model:               85
Model name:          Intel(R) Xeon(R) Platinum 8268 CPU @ 2.90GHz
Stepping:            7
CPU MHz:             2900.000
CPU max MHz:         3900.0000
CPU min MHz:         1200.0000
BogoMIPS:            5800.00
L1d cache:           32K
L1i cache:           32K
L2 cache:            1024K
L3 cache:            36608K
NUMA node0 CPU(s):   0-3,7-9,13-15,19,20,48-51,55-57,61-63,67,68
NUMA node1 CPU(s):   4-6,10-12,16-18,21-23,52-54,58-60,64-66,69-71
NUMA node2 CPU(s):   24-27,31-33,37-39,43,44,72-75,79-81,85-87,91,92
NUMA node3 CPU(s):   28-30,34-36,40-42,45-47,76-78,82-84,88-90,93-95
Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 cdp_l3 invpcid_single intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm mpx rdt_a avx512f avx512dq rdseed adx smap clflushopt clwb intel_pt avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local dtherm ida arat pln pts hwp hwp_act_window hwp_epp hwp_pkg_req pku ospke avx512_vnni md_clear flush_l1d arch_capabilities
sys.argv ['./pred_GWN_16_adpAdj.py', '1', '0.7', '0', '6', '100', 'METRLA', '6', '1', '0.0', '1', '1', '2', '207', '0.01', '50', '100', '0', '0.0003', '0']
P.DATANAME == METRLA
data.shape (34272, 207)
pred_METRLA_GraphWaveNet_2410310820_3736684 data splits Thu Oct 31 08:20:55 2024
spatialSplit_unseen all: trn/val/tst : 207 : 144 / 20 / 41
[122  11 120 157 165  71  96  19   4   6  98  56  30 156 149  38  87  99
 163  13  12  94 203 107 181 206  84  61 112 134 191  83 174 189  18 202
   0 118 111 116  53   2 103  52  64  16  89  97  49 128 143  54  59 131
  35 104 183 188 141   5 167 176  90 186  51  72  27 151 117  37  81  48
 115  23  93  32 166  88  45  95 175  39 145 187 100   7  17 197  44 126
 155 108  92  46  55 121 178  91  34  69 164 168 136 137 102  20  58  74
 162  60 179 148 144 142   3  22  14 113  29 140 205  76  21 198 173 152
 158  65  73 195 160 146 101 169   9 153 159 184  47 182 190 180  33 196]
[165  46 189 202 155  30  32 109  12  85  70 123  28  13 181 145  88 153
  61 168]
[197 104 134  60  70   2  72 178 138 135  98 151 115  95  78  75  15 169
 147 120 141  43  77  59  45  52  51 103  50  22 112 119  87  88 121 105
   1 184 101 183 185]
spatialSplit_allNod all: trn/val/tst : 207 : 144 / 165 / 207
[122  11 120 157 165  71  96  19   4   6  98  56  30 156 149  38  87  99
 163  13  12  94 203 107 181 206  84  61 112 134 191  83 174 189  18 202
   0 118 111 116  53   2 103  52  64  16  89  97  49 128 143  54  59 131
  35 104 183 188 141   5 167 176  90 186  51  72  27 151 117  37  81  48
 115  23  93  32 166  88  45  95 175  39 145 187 100   7  17 197  44 126
 155 108  92  46  55 121 178  91  34  69 164 168 136 137 102  20  58  74
 162  60 179 148 144 142   3  22  14 113  29 140 205  76  21 198 173 152
 158  65  73 195 160 146 101 169   9 153 159 184  47 182 190 180  33 196]
[165  46 189 202 155  30  32 109  12  85  70 123  28  13 181 145  88 153
  61 168 115 140  40 128  45  25  51 175 143  93 112  89  73 119 113 106
 136   4  95 191  80  31 134 180 156 199  59 121  56 103  17 171 146  53
 193  92 204  10 157 150 101 177 111  76  43 158 142  48 196  68 129  75
 107  90  57 174  71 116 108 169 178  87 160 120 164  35 117 152  55  79
  98 201  37  15 162 147 138 137  27  19 198 163  72 206  54 173  16 184
 182  44 100  69 132  65 190  77  18 148  83  50  81  22  42 122  66 105
 159 179   3  74 166 126 151   7   1 114 194   5 110 172 203 125  78   0
 205 135 183  60 118  52 131  96  23   8   6  21 102  67 188 195 104  84
 139  82 197]
[197 104 134  60  70   2  72 178 138 135  98 151 115  95  78  75  15 169
 147 120 141  43  77  59  45  52  51 103  50  22 112 119  87  88 121 105
   1 184 101 183 185  39  24 150 102 159  10  79  32 145  81 199 194   0
  37 191 127 133 106 100  12 175 203 152  56 126 182  34  84 117 196 164
  19  53  27 155 163 156  29 171 205  94  64 187  13 114  80 132 161  99
 118  57  36  17 206 136  48 148 165 177   4  68 125 204 154 162 122 201
  33 195 190  38  46  14 186  28 107  93  89  41  40 140 166 111   7  83
 123  11  63   6  76 180  18  23 131 113   9  67 189 198 110 188  25  71
 153 128 146 124 129 181 168 167 176  30  42  66  31 158 202  21  16 179
  35 137 143 149  49  69  92  26  73   5  47  82  58  54  44 144 160 192
 173 109   8 130 172  91  97  96 108 142   3  65 139  85  20 193  74  62
  61 157 174 170  90  55  86 116 200]
train.shape torch.Size([23969, 2, 144, 12]) torch.Size([23969, 12, 144, 1])
val_u.shape torch.Size([3425, 2, 20, 12]) torch.Size([3425, 12, 20, 1])
val_a.shape torch.Size([3425, 2, 165, 12]) torch.Size([3425, 12, 165, 1])
tst_u.shape torch.Size([6844, 2, 41, 12]) torch.Size([6844, 12, 41, 1])
tst_a.shape torch.Size([6844, 2, 207, 12]) torch.Size([6844, 12, 207, 1])
adj_train 2 torch.Size([144, 144]) torch.Size([144, 144])
adj_val_u 2 torch.Size([20, 20]) torch.Size([20, 20])
adj_val_a 2 torch.Size([165, 165]) torch.Size([165, 165])
adj_tst_u 2 torch.Size([41, 41]) torch.Size([41, 41])
adj_tst_a 2 torch.Size([207, 207]) torch.Size([207, 207])
TIMESTEP_IN 12
TIMESTEP_OUT 12
CHANNEL 2
BATCHSIZE 64
LEARN 0.001
PRETRN_EPOCH 50
EPOCH 100
TRAINRATIO 0.8
TRAINVALSPLIT 0.125
ADJTYPE doubletransition
MODELNAME GraphWaveNet
FEATURES 2
SUBGRAPH_SIZE 207
QUOTIENT_GRAPH_RADIUS 0.01
NETWORK_CALLS False
PRE_LEARN 0.0003
GRAPH_NORM False
IS_PRETRN True
R_TRN 0.7
IS_EPOCH_1 False
seed 6
TEMPERATURE 100.0
DATANAME METRLA
seed_SS 6
IS_DESEASONED True
weight_decay 0.0
adp_adj True
is_SGA True
KEYWORD pred_METRLA_GraphWaveNet_2410310820_3736684
PATH ../save/pred_METRLA_GraphWaveNet_2410310820_3736684
FLOWPATH ../METRLA/metr-la.h5
n_dct_coeff 3918
ADJPATH ../METRLA/adj_mx.pkl
N_NODE 207
trainval_size 27394
train_size 23969
pred_METRLA_GraphWaveNet_2410310820_3736684 pretraining started Thu Oct 31 08:20:59 2024
pretrainModel Started ... Thu Oct 31 08:20:59 2024
epoch 0 time used: 6  seconds  train loss: 6.011475965380669 validation loss: 6.01128625869751
epoch 1 time used: 4  seconds  train loss: 6.008818335831165 validation loss: 6.010575294494629
epoch 2 time used: 4  seconds  train loss: 6.008686892688274 validation loss: 6.0123162269592285
epoch 3 time used: 4  seconds  train loss: 6.0086542293429375 validation loss: 6.01192045211792
epoch 4 time used: 4  seconds  train loss: 6.008617624640465 validation loss: 6.011789798736572
epoch 5 time used: 4  seconds  train loss: 6.008632257580757 validation loss: 6.011465072631836
epoch 6 time used: 4  seconds  train loss: 6.008627831935883 validation loss: 6.011664867401123
epoch 7 time used: 4  seconds  train loss: 6.008604936301708 validation loss: 6.011327743530273
epoch 8 time used: 4  seconds  train loss: 6.008609317243099 validation loss: 6.0107316970825195
epoch 9 time used: 4  seconds  train loss: 6.008599452674389 validation loss: 6.010373592376709
epoch 10 time used: 4  seconds  train loss: 6.008601367473602 validation loss: 6.011011123657227
epoch 11 time used: 4  seconds  train loss: 6.008594743907452 validation loss: 6.011284351348877
epoch 12 time used: 4  seconds  train loss: 6.008592166006565 validation loss: 6.011091232299805
epoch 13 time used: 4  seconds  train loss: 6.008601970970631 validation loss: 6.011167526245117
epoch 14 time used: 4  seconds  train loss: 6.008589886128902 validation loss: 6.0111308097839355
epoch 15 time used: 4  seconds  train loss: 6.0085901618003845 validation loss: 6.01101016998291
epoch 16 time used: 4  seconds  train loss: 6.008589752018452 validation loss: 6.011239051818848
epoch 17 time used: 4  seconds  train loss: 6.008586876094341 validation loss: 6.010982990264893
epoch 18 time used: 4  seconds  train loss: 6.008587285876274 validation loss: 6.010880470275879
epoch 19 time used: 4  seconds  train loss: 6.0085882768034935 validation loss: 6.010565280914307
epoch 20 time used: 4  seconds  train loss: 6.008586324751377 validation loss: 6.010708332061768
epoch 21 time used: 4  seconds  train loss: 6.008585847914219 validation loss: 6.010704517364502
epoch 22 time used: 4  seconds  train loss: 6.008585296571255 validation loss: 6.01057767868042
epoch 23 time used: 4  seconds  train loss: 6.008583270013332 validation loss: 6.010561943054199
epoch 24 time used: 4  seconds  train loss: 6.008584097027779 validation loss: 6.01057767868042
epoch 25 time used: 4  seconds  train loss: 6.008584156632423 validation loss: 6.010903358459473
epoch 26 time used: 4  seconds  train loss: 6.008586302399635 validation loss: 6.010619163513184
epoch 27 time used: 4  seconds  train loss: 6.00858373939991 validation loss: 6.010634422302246
epoch 28 time used: 4  seconds  train loss: 6.008583754301071 validation loss: 6.01032018661499
epoch 29 time used: 4  seconds  train loss: 6.00858274102211 validation loss: 6.010151386260986
epoch 30 time used: 4  seconds  train loss: 6.008582688868046 validation loss: 6.010458946228027
epoch 31 time used: 4  seconds  train loss: 6.008581340312958 validation loss: 6.0103068351745605
epoch 32 time used: 4  seconds  train loss: 6.008581943809986 validation loss: 6.010189533233643
epoch 33 time used: 4  seconds  train loss: 6.008583225309849 validation loss: 6.0101423263549805
epoch 34 time used: 4  seconds  train loss: 6.008582457900047 validation loss: 6.010433673858643
epoch 35 time used: 4  seconds  train loss: 6.00858174264431 validation loss: 6.0099053382873535
epoch 36 time used: 4  seconds  train loss: 6.008581317961216 validation loss: 6.0106353759765625
epoch 37 time used: 4  seconds  train loss: 6.008581914007664 validation loss: 6.01079797744751
epoch 38 time used: 4  seconds  train loss: 6.008581161499023 validation loss: 6.010289669036865
epoch 39 time used: 4  seconds  train loss: 6.008580423891544 validation loss: 6.010544300079346
epoch 40 time used: 4  seconds  train loss: 6.0085795894265175 validation loss: 6.010572910308838
epoch 41 time used: 4  seconds  train loss: 6.008580133318901 validation loss: 6.0103912353515625
epoch 42 time used: 4  seconds  train loss: 6.008581750094891 validation loss: 6.010736465454102
epoch 43 time used: 4  seconds  train loss: 6.008580647408962 validation loss: 6.0106730461120605
epoch 44 time used: 4  seconds  train loss: 6.0085816234350204 validation loss: 6.010150909423828
epoch 45 time used: 4  seconds  train loss: 6.008579954504967 validation loss: 6.010434150695801
epoch 46 time used: 4  seconds  train loss: 6.008580803871155 validation loss: 6.0102314949035645
epoch 47 time used: 4  seconds  train loss: 6.008578568696976 validation loss: 6.010292053222656
epoch 48 time used: 4  seconds  train loss: 6.0085800513625145 validation loss: 6.010576248168945
epoch 49 time used: 4  seconds  train loss: 6.008579425513744 validation loss: 6.010723114013672
PRETIME DURATION: 2024-10-31 08:25:11.996289 - 2024-10-31 08:20:59.113424 = 0:04:12.882865
pretrainModel Ended ... Thu Oct 31 08:25:11 2024
pred_METRLA_GraphWaveNet_2410310820_3736684 training started Thu Oct 31 08:25:12 2024
trainModel Started ... Thu Oct 31 08:25:12 2024
TIMESTEP_IN, TIMESTEP_OUT 12 12
Model Training Started ... 2024-10-31 08:25:12.839509
train_embed torch.Size([32, 144]) tensor(0.2062, device='cuda:0') tensor(0.2944, device='cuda:0')
val_u_embed torch.Size([32, 20]) tensor(0.2371, device='cuda:0') tensor(0.3094, device='cuda:0')
val_a_embed torch.Size([32, 165]) tensor(0.2054, device='cuda:0') tensor(0.2876, device='cuda:0')
epoch 0 time used: 27  seconds  train loss: 0.25088130009204684 validation unseen nodes loss: 0.2284633884160188 validation all nodes loss: 0.2249439876053455
epoch 1 time used: 27  seconds  train loss: 0.22428769553586486 validation unseen nodes loss: 0.2516018959510065 validation all nodes loss: 0.2205612864416011
epoch 2 time used: 28  seconds  train loss: 0.21912272856888423 validation unseen nodes loss: 0.2636453781075721 validation all nodes loss: 0.21953844634285807
epoch 3 time used: 26  seconds  train loss: 0.21522342887916057 validation unseen nodes loss: 0.2882508759777041 validation all nodes loss: 0.22025439097498456
epoch 4 time used: 26  seconds  train loss: 0.2105491844994478 validation unseen nodes loss: 0.29575848476730127 validation all nodes loss: 0.22367420277456299
epoch 5 time used: 26  seconds  train loss: 0.20817728474785327 validation unseen nodes loss: 0.31514664014760596 validation all nodes loss: 0.22191445784847233
epoch 6 time used: 26  seconds  train loss: 0.2051118218564058 validation unseen nodes loss: 0.3084239530824397 validation all nodes loss: 0.225196326222733
epoch 7 time used: 26  seconds  train loss: 0.20288453951358018 validation unseen nodes loss: 0.29274010728745564 validation all nodes loss: 0.2250524880677244
epoch 8 time used: 26  seconds  train loss: 0.20031831523390237 validation unseen nodes loss: 0.2816067304184837 validation all nodes loss: 0.22845556590243848
epoch 9 time used: 26  seconds  train loss: 0.19890109206142192 validation unseen nodes loss: 0.28890186160150233 validation all nodes loss: 0.23031917400603746
epoch 10 time used: 26  seconds  train loss: 0.1974589599452571 validation unseen nodes loss: 0.27000392584035 validation all nodes loss: 0.22227560999184628
epoch 11 time used: 26  seconds  train loss: 0.19656282755479013 validation unseen nodes loss: 0.27391465871003423 validation all nodes loss: 0.22514439866490607
epoch 12 time used: 26  seconds  train loss: 0.19505844503794062 validation unseen nodes loss: 0.27612217451099064 validation all nodes loss: 0.22474570197780638
epoch 13 time used: 26  seconds  train loss: 0.19384207083921398 validation unseen nodes loss: 0.2818267760181079 validation all nodes loss: 0.22807524309976257
epoch 14 time used: 26  seconds  train loss: 0.19380178240326917 validation unseen nodes loss: 0.2819356109930651 validation all nodes loss: 0.23342943399491972
epoch 15 time used: 26  seconds  train loss: 0.19334514953985277 validation unseen nodes loss: 0.29030662745019814 validation all nodes loss: 0.2271247848281025
epoch 16 time used: 26  seconds  train loss: 0.19220327476861007 validation unseen nodes loss: 0.27717084778051304 validation all nodes loss: 0.22622698179561726
epoch 17 time used: 26  seconds  train loss: 0.1916774043730897 validation unseen nodes loss: 0.2847485168789425 validation all nodes loss: 0.22729065460445236
epoch 18 time used: 26  seconds  train loss: 0.19115403762443217 validation unseen nodes loss: 0.2968510187063774 validation all nodes loss: 0.2285014748225247
epoch 19 time used: 26  seconds  train loss: 0.1901295762180392 validation unseen nodes loss: 0.2844099692445602 validation all nodes loss: 0.22646820580872307
epoch 20 time used: 26  seconds  train loss: 0.18887389994773207 validation unseen nodes loss: 0.2806715241313851 validation all nodes loss: 0.24242274786869106
epoch 21 time used: 26  seconds  train loss: 0.18905586895007076 validation unseen nodes loss: 0.2784630242142364 validation all nodes loss: 0.22671416453636475
epoch 22 time used: 26  seconds  train loss: 0.1877605526404723 validation unseen nodes loss: 0.28274201422277156 validation all nodes loss: 0.23234536086990887
epoch 23 time used: 26  seconds  train loss: 0.18787586449149393 validation unseen nodes loss: 0.2914972976524464 validation all nodes loss: 0.2303868946541835
epoch 24 time used: 26  seconds  train loss: 0.18703350955809633 validation unseen nodes loss: 0.29837910498580794 validation all nodes loss: 0.22949810403976997
epoch 25 time used: 26  seconds  train loss: 0.18636670590784887 validation unseen nodes loss: 0.293613373245636 validation all nodes loss: 0.2279801094662534
epoch 26 time used: 26  seconds  train loss: 0.18662056076327205 validation unseen nodes loss: 0.2899774842105643 validation all nodes loss: 0.23008182208033373
epoch 27 time used: 26  seconds  train loss: 0.18648504713528685 validation unseen nodes loss: 0.3142154179741866 validation all nodes loss: 0.2350919688531082
epoch 28 time used: 26  seconds  train loss: 0.18561185079316403 validation unseen nodes loss: 0.28095672216728657 validation all nodes loss: 0.22779164875510835
epoch 29 time used: 26  seconds  train loss: 0.1845395092440664 validation unseen nodes loss: 0.27012791347764703 validation all nodes loss: 0.2282615019979268
epoch 30 time used: 26  seconds  train loss: 0.1828030055253048 validation unseen nodes loss: 0.2843643815456516 validation all nodes loss: 0.23456442152931742
epoch 31 time used: 26  seconds  train loss: 0.1819221634632098 validation unseen nodes loss: 0.29148565098317 validation all nodes loss: 0.23425344247017463
epoch 32 time used: 26  seconds  train loss: 0.18174782875054787 validation unseen nodes loss: 0.29080792924348453 validation all nodes loss: 0.23346176863151746
epoch 33 time used: 26  seconds  train loss: 0.18015481943672662 validation unseen nodes loss: 0.2926445737633392 validation all nodes loss: 0.23212429070994803
epoch 34 time used: 26  seconds  train loss: 0.17982771991191368 validation unseen nodes loss: 0.294217121627209 validation all nodes loss: 0.24204461629373314
epoch 35 time used: 26  seconds  train loss: 0.18213400036448446 validation unseen nodes loss: 0.2928207030174506 validation all nodes loss: 0.23617597178821145
epoch 36 time used: 26  seconds  train loss: 0.18041285801463017 validation unseen nodes loss: 0.33386058770392063 validation all nodes loss: 0.23538516061584444
epoch 37 time used: 26  seconds  train loss: 0.18002768621209855 validation unseen nodes loss: 0.2758529496976059 validation all nodes loss: 0.2343479830461697
epoch 38 time used: 26  seconds  train loss: 0.18091803596851708 validation unseen nodes loss: 0.3594262082646363 validation all nodes loss: 0.2339782237092944
epoch 39 time used: 26  seconds  train loss: 0.18335271672311465 validation unseen nodes loss: 0.29476629490834955 validation all nodes loss: 0.2331136782151939
epoch 40 time used: 26  seconds  train loss: 0.1785640353059892 validation unseen nodes loss: 0.41846615921841923 validation all nodes loss: 0.2387112272568863
epoch 41 time used: 26  seconds  train loss: 0.17882061117723125 validation unseen nodes loss: 0.3213985666654406 validation all nodes loss: 0.23271337764976668
epoch 42 time used: 26  seconds  train loss: 0.18079216140678497 validation unseen nodes loss: 0.2870016230718933 validation all nodes loss: 0.2379981395754501
epoch 43 time used: 26  seconds  train loss: 0.1782835026061939 validation unseen nodes loss: 0.3250532563280885 validation all nodes loss: 0.23548709334683243
epoch 44 time used: 26  seconds  train loss: 0.17746067076151817 validation unseen nodes loss: 0.3235359160177899 validation all nodes loss: 0.23282574271633677
epoch 45 time used: 27  seconds  train loss: 0.1765776871932384 validation unseen nodes loss: 0.29590043474722955 validation all nodes loss: 0.2315741025705407
epoch 46 time used: 26  seconds  train loss: 0.1760269624248972 validation unseen nodes loss: 0.29793951381732076 validation all nodes loss: 0.24839496487248552
epoch 47 time used: 26  seconds  train loss: 0.18031533187976184 validation unseen nodes loss: 0.27665647348348243 validation all nodes loss: 0.24128342879949696
epoch 48 time used: 26  seconds  train loss: 0.17739802432901255 validation unseen nodes loss: 0.28980631634266707 validation all nodes loss: 0.24875016673638004
epoch 49 time used: 26  seconds  train loss: 0.1767808106328893 validation unseen nodes loss: 0.5128415909648811 validation all nodes loss: 0.24081692488524165
epoch 50 time used: 26  seconds  train loss: 0.17427608590795168 validation unseen nodes loss: 0.305238892414274 validation all nodes loss: 0.23542632563705862
epoch 51 time used: 26  seconds  train loss: 0.17369668094261084 validation unseen nodes loss: 0.4025606414262396 validation all nodes loss: 0.2456923569684481
epoch 52 time used: 26  seconds  train loss: 0.1738015005204231 validation unseen nodes loss: 0.29937353257715266 validation all nodes loss: 0.24862952585202935
epoch 53 time used: 26  seconds  train loss: 0.17640056671629342 validation unseen nodes loss: 0.2690164824167307 validation all nodes loss: 0.23540726975802959
epoch 54 time used: 26  seconds  train loss: 0.1727824742014494 validation unseen nodes loss: 0.4105325747841466 validation all nodes loss: 0.2376883974084019
epoch 55 time used: 26  seconds  train loss: 0.1709726843954182 validation unseen nodes loss: 0.41887883299458634 validation all nodes loss: 0.23593076646763042
epoch 56 time used: 26  seconds  train loss: 0.17201076016887526 validation unseen nodes loss: 0.30352658801705296 validation all nodes loss: 0.23641900559846502
epoch 57 time used: 26  seconds  train loss: 0.17225256842177603 validation unseen nodes loss: 0.4729624544486512 validation all nodes loss: 0.24068596307813686
epoch 58 time used: 26  seconds  train loss: 0.17166658450144792 validation unseen nodes loss: 0.306305786871562 validation all nodes loss: 0.23731489684459936
epoch 59 time used: 26  seconds  train loss: 0.17017791123708798 validation unseen nodes loss: 0.42761602456552267 validation all nodes loss: 0.23570778871974807
epoch 60 time used: 26  seconds  train loss: 0.17157699665014037 validation unseen nodes loss: 1.107799844202334 validation all nodes loss: 0.24010377169525537
epoch 61 time used: 26  seconds  train loss: 0.16638186147133505 validation unseen nodes loss: 1.3461202215452264 validation all nodes loss: 0.24397801191702376
epoch 62 time used: 26  seconds  train loss: 0.165567836400052 validation unseen nodes loss: 0.5049128748770177 validation all nodes loss: 0.24449993612122362
epoch 63 time used: 26  seconds  train loss: 0.16627625860620426 validation unseen nodes loss: 0.9414420508816295 validation all nodes loss: 0.24331185319562898
epoch 64 time used: 26  seconds  train loss: 0.16615563913613446 validation unseen nodes loss: 0.5167435387581805 validation all nodes loss: 0.24927904503623935
epoch 65 time used: 26  seconds  train loss: 0.17348952742302104 validation unseen nodes loss: 0.7035478240773626 validation all nodes loss: 0.24184874575938622
epoch 66 time used: 26  seconds  train loss: 0.16743629049427236 validation unseen nodes loss: 0.9172079763186239 validation all nodes loss: 0.2504439993539866
epoch 67 time used: 26  seconds  train loss: 0.17001043779390757 validation unseen nodes loss: 0.9431165050677139 validation all nodes loss: 0.24812694784498562
epoch 68 time used: 26  seconds  train loss: 0.1659323847636029 validation unseen nodes loss: 0.9058203383170775 validation all nodes loss: 0.24722859652808113
epoch 69 time used: 26  seconds  train loss: 0.16445018028237154 validation unseen nodes loss: 0.8834530079277763 validation all nodes loss: 0.24728133500927557
epoch 70 time used: 26  seconds  train loss: 0.16421853475320214 validation unseen nodes loss: 0.7565445256494258 validation all nodes loss: 0.245854149513001
epoch 71 time used: 26  seconds  train loss: 0.16446023365300302 validation unseen nodes loss: 0.8878192250702504 validation all nodes loss: 0.24851183695079637
epoch 72 time used: 26  seconds  train loss: 0.1635786979163343 validation unseen nodes loss: 1.4366906431295576 validation all nodes loss: 0.2600585086893861
epoch 73 time used: 26  seconds  train loss: 0.16404003782213453 validation unseen nodes loss: 1.4161914048229691 validation all nodes loss: 0.2467352447327036
epoch 74 time used: 26  seconds  train loss: 0.1632845289425486 validation unseen nodes loss: 1.23024383372634 validation all nodes loss: 0.24900466418179282
epoch 75 time used: 26  seconds  train loss: 0.16719269317136629 validation unseen nodes loss: 0.731703091720595 validation all nodes loss: 0.24776930929535496
epoch 76 time used: 26  seconds  train loss: 0.16683225287126457 validation unseen nodes loss: 0.4069200880031516 validation all nodes loss: 0.24903713071868366
epoch 77 time used: 26  seconds  train loss: 0.16499094989196922 validation unseen nodes loss: 0.3428842872033154 validation all nodes loss: 0.24396967588114912
epoch 78 time used: 26  seconds  train loss: 0.1624777155179067 validation unseen nodes loss: 0.614505876289667 validation all nodes loss: 0.2501429586123376
epoch 79 time used: 26  seconds  train loss: 0.16426544066620657 validation unseen nodes loss: 1.2582574067672674 validation all nodes loss: 0.2541171613183335
epoch 80 time used: 26  seconds  train loss: 0.16183422606040054 validation unseen nodes loss: 0.699859134820256 validation all nodes loss: 0.2495593858069747
epoch 81 time used: 26  seconds  train loss: 0.16105683008276866 validation unseen nodes loss: 1.2225084356495934 validation all nodes loss: 0.2526541537046432
epoch 82 time used: 26  seconds  train loss: 0.16767924202476228 validation unseen nodes loss: 0.9955337237615655 validation all nodes loss: 0.2522917680148661
epoch 83 time used: 26  seconds  train loss: 0.16174561169308235 validation unseen nodes loss: 1.2815025452105668 validation all nodes loss: 0.24764641164863196
epoch 84 time used: 26  seconds  train loss: 0.16255267983936358 validation unseen nodes loss: 0.571953034487954 validation all nodes loss: 0.2500858379236973
epoch 85 time used: 26  seconds  train loss: 0.16440921124339605 validation unseen nodes loss: 0.32970068097114563 validation all nodes loss: 0.24639903443138095
epoch 86 time used: 26  seconds  train loss: 0.1641091365252007 validation unseen nodes loss: 0.5872364425398138 validation all nodes loss: 0.24333321249398002
epoch 87 time used: 26  seconds  train loss: 0.16171990231041955 validation unseen nodes loss: 0.9935423590493028 validation all nodes loss: 0.25031900641691945
epoch 88 time used: 26  seconds  train loss: 0.16091810253001287 validation unseen nodes loss: 0.78089855770125 validation all nodes loss: 0.25386832119339575
epoch 89 time used: 26  seconds  train loss: 0.1597638571030844 validation unseen nodes loss: 0.4948904703481354 validation all nodes loss: 0.2504990171820578
epoch 90 time used: 26  seconds  train loss: 0.16325861597181515 validation unseen nodes loss: 0.5625986738709637 validation all nodes loss: 0.2492894140995332
epoch 91 time used: 26  seconds  train loss: 0.16089947821649433 validation unseen nodes loss: 0.46763353399116625 validation all nodes loss: 0.25208232263578984
epoch 92 time used: 26  seconds  train loss: 0.16047765891875446 validation unseen nodes loss: 0.9492615674533983 validation all nodes loss: 0.25389137994633976
epoch 93 time used: 26  seconds  train loss: 0.15879813865846099 validation unseen nodes loss: 1.3931664347474593 validation all nodes loss: 0.24996928517400782
epoch 94 time used: 26  seconds  train loss: 0.16319797047325257 validation unseen nodes loss: 0.2932509770706622 validation all nodes loss: 0.24769459079651937
epoch 95 time used: 26  seconds  train loss: 0.17229935414322903 validation unseen nodes loss: 1.050070669041933 validation all nodes loss: 0.2436979011593074
epoch 96 time used: 26  seconds  train loss: 0.16128576766828398 validation unseen nodes loss: 1.8839943086317856 validation all nodes loss: 0.25394195687596816
epoch 97 time used: 26  seconds  train loss: 0.15854246282133383 validation unseen nodes loss: 1.5116062222780102 validation all nodes loss: 0.2557734615306785
epoch 98 time used: 26  seconds  train loss: 0.15986709003578992 validation unseen nodes loss: 0.7026375316094308 validation all nodes loss: 0.24678738662796298
epoch 99 time used: 26  seconds  train loss: 0.15997244127091947 validation unseen nodes loss: 1.1583802065187998 validation all nodes loss: 0.24828244620431078
MODEL TRAINING DURATION: 2024-10-31 09:10:11.578014 - 2024-10-31 08:25:12.839509 = 0:44:58.738505
****************************************
GraphWaveNet, train, MAE on train, 1.6303653448e-01, 0.1630365345
min_val_u_loss 0.2284633884160188
min_val_a_loss 0.21953844634285807
trainModel Ended ... Thu Oct 31 09:10:20 2024
pred_METRLA_GraphWaveNet_2410310820_3736684 testing started Thu Oct 31 09:10:20 2024
Model Testing test_u Started ... Thu Oct 31 09:10:20 2024
TIMESTEP_IN, TIMESTEP_OUT 12 12
Model Infer Start ... 2024-10-31 09:10:20.532206
Model Infer End ... 2024-10-31 09:10:28.238761
MODEL INFER DURATION: 2024-10-31 09:10:28.238761 - 2024-10-31 09:10:20.532206 = 0:00:07.706555
YS.shape, YS_pred.shape, (6844, 12, 41, 1) (6844, 12, 41, 1)
YS.shape, YS_pred.shape, (6844, 12, 41) (6844, 12, 41)
****************************************
GraphWaveNet, test_u, Torch MSE, 2.5111715319e-01, 0.2511171532
all pred steps, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 103.4252853394, 10.1698226929, 4.5758881569, 11.0700257123
1 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 31.8877525330, 5.6469240189, 2.7662205696, 6.1078615487
2 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 45.7735366821, 6.7656145096, 3.1954629421, 7.3161900043
3 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 59.7605781555, 7.7304964066, 3.5226666927, 8.2926630974
4 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 74.4445724487, 8.6281270981, 3.8753056526, 9.1983310878
5 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 88.4052734375, 9.4024076462, 4.2088251114, 10.0718475878
6 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 102.4735794067, 10.1229238510, 4.5509376526, 10.9165996313
7 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 114.0783004761, 10.6807441711, 4.8197588921, 11.6818346083
8 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 123.7514495850, 11.1243629456, 5.0876803398, 12.5032454729
9 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 133.8071441650, 11.5675039291, 5.3304910660, 13.1873741746
10 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 146.0815734863, 12.0864210129, 5.6491670609, 13.8784006238
11 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 154.8437194824, 12.4436216354, 5.8518409729, 14.5565703511
12 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 165.8031463623, 12.8764572144, 6.0524511337, 15.1299238205
Model Testing Ended ... Thu Oct 31 09:10:30 2024
Model Testing test_a Started ... Thu Oct 31 09:10:30 2024
TIMESTEP_IN, TIMESTEP_OUT 12 12
Model Infer Start ... 2024-10-31 09:10:30.750180
Model Infer End ... 2024-10-31 09:10:40.886173
MODEL INFER DURATION: 2024-10-31 09:10:40.886173 - 2024-10-31 09:10:30.750180 = 0:00:10.135993
YS.shape, YS_pred.shape, (6844, 12, 207, 1) (6844, 12, 207, 1)
YS.shape, YS_pred.shape, (6844, 12, 207) (6844, 12, 207)
****************************************
GraphWaveNet, test_a, Torch MSE, 2.5083342042e-01, 0.2508334204
all pred steps, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 99.4982757568, 9.9748821259, 4.4774961472, 11.6882443428
1 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 32.7516174316, 5.7229027748, 2.7916169167, 6.5982647240
2 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 48.3308105469, 6.9520363808, 3.2255845070, 7.7766038477
3 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 60.0852775574, 7.7514696121, 3.5294258595, 8.8067427278
4 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 74.0851516724, 8.6072731018, 3.8752088547, 9.7872585058
5 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 87.8107376099, 9.3707380295, 4.1705002785, 10.5629421771
6 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 97.8054275513, 9.8896627426, 4.4712381363, 11.6829790175
7 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 107.4778976440, 10.3671550751, 4.7445673943, 12.5869363546
8 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 119.6277770996, 10.9374485016, 4.9695897102, 13.1845265627
9 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 129.1879425049, 11.3660869598, 5.2175278664, 13.8851732016
10 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 136.3402862549, 11.6764841080, 5.3715119362, 14.5343333483
11 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 145.6475219727, 12.0684518814, 5.5782251358, 15.1160627604
12 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 154.8365631104, 12.4433336258, 5.7851309776, 15.7375678420
Model Testing Ended ... Thu Oct 31 09:10:48 2024
SCRIPT DURATION 0:49:56.715797

======================================================================================
                  Resource Usage on 2024-10-31 09:10:56:
   Job Id:             127921527.gadi-pbs
   Project:            hn98
   Exit Status:        0
   Service Units:      30.53
   NCPUs Requested:    12                     NCPUs Used: 12              
                                           CPU Time Used: 00:49:48        
   Memory Requested:   8.0GB                 Memory Used: 5.24GB          
   NGPUs Requested:    1                 GPU Utilisation: 58%             
                                         GPU Memory Used: 2.32GB          
   Walltime requested: 03:00:00            Walltime Used: 00:50:53        
   JobFS requested:    100.0MB                JobFS used: 17.52KB         
======================================================================================
