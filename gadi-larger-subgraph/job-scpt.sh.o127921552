Package                  Version
------------------------ -----------
aiohappyeyeballs         2.4.3
aiohttp                  3.10.10
aiosignal                1.3.1
async-timeout            4.0.3
attrs                    24.2.0
blosc2                   2.5.1
certifi                  2024.8.30
charset-normalizer       3.4.0
click                    8.1.7
click-plugins            1.1.1
cligj                    0.7.2
contourpy                1.3.0
cycler                   0.12.1
filelock                 3.16.1
fiona                    1.10.1
fonttools                4.54.1
frozenlist               1.5.0
fsspec                   2024.10.0
geopandas                0.14.4
idna                     3.10
importlib-metadata       8.5.0
importlib-resources      6.4.5
jinja2                   3.1.4
joblib                   1.4.2
kiwisolver               1.4.7
MarkupSafe               3.0.2
matplotlib               3.9.2
mpmath                   1.3.0
msgpack                  1.1.0
multidict                6.1.0
ndindex                  1.9.2
networkx                 3.2.1
numexpr                  2.10.1
numpy                    1.26.4
nvidia-cublas-cu12       12.4.5.8
nvidia-cuda-cupti-cu12   12.4.127
nvidia-cuda-nvrtc-cu12   12.4.127
nvidia-cuda-runtime-cu12 12.4.127
nvidia-cudnn-cu12        9.1.0.70
nvidia-cufft-cu12        11.2.1.3
nvidia-curand-cu12       10.3.5.147
nvidia-cusolver-cu12     11.6.1.9
nvidia-cusparse-cu12     12.3.1.170
nvidia-nccl-cu12         2.21.5
nvidia-nvjitlink-cu12    12.4.127
nvidia-nvtx-cu12         12.4.127
osmnx                    1.9.4
packaging                24.1
pandas                   2.2.3
pillow                   11.0.0
pip                      20.2.3
propcache                0.2.0
psutil                   6.1.0
py-cpuinfo               9.0.0
pyparsing                3.2.0
pyproj                   3.6.1
python-dateutil          2.9.0.post0
pytz                     2024.2
requests                 2.32.3
scikit-learn             1.5.2
scipy                    1.13.1
setuptools               49.2.1
shapely                  2.0.6
six                      1.16.0
sympy                    1.13.1
tables                   3.9.2
threadpoolctl            3.5.0
torch                    2.5.0
torch-geometric          2.6.1
torchaudio               2.5.0
torchvision              0.20.0
tqdm                     4.66.5
triton                   3.1.0
typing-extensions        4.12.2
tzdata                   2024.2
urllib3                  2.2.3
yarl                     1.16.0
zipp                     3.20.2
/g/data/hn98/matt/forecasting-on-new-roads
Thu Oct 31 08:23:38 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-SXM2-32GB           On  |   00000000:B1:00.0 Off |                    0 |
| N/A   30C    P0             43W /  300W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Architecture:        x86_64
CPU op-mode(s):      32-bit, 64-bit
Byte Order:          Little Endian
CPU(s):              96
On-line CPU(s) list: 0-95
Thread(s) per core:  2
Core(s) per socket:  24
Socket(s):           2
NUMA node(s):        4
Vendor ID:           GenuineIntel
CPU family:          6
Model:               85
Model name:          Intel(R) Xeon(R) Platinum 8268 CPU @ 2.90GHz
Stepping:            7
CPU MHz:             2900.000
CPU max MHz:         3900.0000
CPU min MHz:         1200.0000
BogoMIPS:            5800.00
L1d cache:           32K
L1i cache:           32K
L2 cache:            1024K
L3 cache:            36608K
NUMA node0 CPU(s):   0-3,6-8,12-14,19,20,48-51,54-56,60-62,67,68
NUMA node1 CPU(s):   4,5,9-11,15-18,21-23,52,53,57-59,63-66,69-71
NUMA node2 CPU(s):   24-27,31,32,36-38,42-44,72-75,79,80,84-86,90-92
NUMA node3 CPU(s):   28-30,33-35,39-41,45-47,76-78,81-83,87-89,93-95
Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 cdp_l3 invpcid_single intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm mpx rdt_a avx512f avx512dq rdseed adx smap clflushopt clwb intel_pt avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local dtherm ida arat pln pts hwp hwp_act_window hwp_epp hwp_pkg_req pku ospke avx512_vnni md_clear flush_l1d arch_capabilities
sys.argv ['./pred_GWN_16_adpAdj.py', '1', '0.7', '0', '9', '100', 'METRLA', '9', '1', '0.0', '1', '1', '2', '207', '0.01', '50', '100', '0', '0.0003', '0']
P.DATANAME == METRLA
data.shape (34272, 207)
pred_METRLA_GraphWaveNet_2410310825_972032 data splits Thu Oct 31 08:25:50 2024
spatialSplit_unseen all: trn/val/tst : 207 : 144 / 20 / 41
[ 27 106 130  80 160  53 181 162  38 127 170  37 145 107   3 186 205 167
  31  39  32 138 185 190  23 100  17  44 173  57  83  20   9  93  75  30
  90  54  26  78 148  13 199 201 156  69  21  28  73  55 103  60  47 111
  25 197 204 196  82  71  15  51   6  11 140 109 149 178 113 155 116  68
  67 101 135  77 121  79   2 175 179  95 158   8  89 163  84 133 142  43
 174  36 146 134  16  86  35 172  33  45   0  42   7  81 157 200 159  88
  97  70 154 189 166  29 164 151  10 194 183 123 122 105  48 131 177 136
  66  41 169  76  94  85  96 118  87 152 102 203  64 193  14 112 176 153]
[ 32   2  33  90  81   4  18 136 103 105 102  41  80  98 184   3 174  93
  17  55]
[ 24  90  49  89  39  68 144  65  94  69 180  11 107  47 102 177  78  25
 178 152 163  43 159  87 129 104  56  19  71 116  16  62 167  32 109 135
  60   4 117  31  40]
spatialSplit_allNod all: trn/val/tst : 207 : 144 / 165 / 207
[ 27 106 130  80 160  53 181 162  38 127 170  37 145 107   3 186 205 167
  31  39  32 138 185 190  23 100  17  44 173  57  83  20   9  93  75  30
  90  54  26  78 148  13 199 201 156  69  21  28  73  55 103  60  47 111
  25 197 204 196  82  71  15  51   6  11 140 109 149 178 113 155 116  68
  67 101 135  77 121  79   2 175 179  95 158   8  89 163  84 133 142  43
 174  36 146 134  16  86  35 172  33  45   0  42   7  81 157 200 159  88
  97  70 154 189 166  29 164 151  10 194 183 123 122 105  48 131 177 136
  66  41 169  76  94  85  96 118  87 152 102 203  64 193  14 112 176 153]
[ 32   2  33  90  81   4  18 136 103 105 102  41  80  98 184   3 174  93
  17  55  65 120 158 170 112 129 165  89  97 172 138  24   0  40 180  47
 166  57  64 185  23  15  67 186 128  27 171  31 149  39  99 167 195 179
  87 126  95 122  71 205 204 161  72 164  42 178 132  13  28  36  69 110
 157 202 159  21 141  74 150 160  52  50  66 146  44 109 182  43  76 191
  53 177 139 127 190  25 124  62   6 111 155  45 106 163 147  10  20 198
 173   9  86  54 187  61  68 181  60  34 148 162  16  88  19 197 107  58
 101 125 119  96 113  14  85 176  82 199 116 135  11  30 206 194  37  70
  38  48 123  79 183 143   1 193 201  51   7 169 200  83 121 145 175 156
 130 153 152]
[ 24  90  49  89  39  68 144  65  94  69 180  11 107  47 102 177  78  25
 178 152 163  43 159  87 129 104  56  19  71 116  16  62 167  32 109 135
  60   4 117  31  40   2  14  72 154  54  44   8 195   3  35  99 128   5
  22 175 100   9 130 121  53  37 141  77 205  88 192  76 124  27  91  21
  64 123 202  10 113 165  97 125 170  55  50 108 188 183 187 126  17  70
 182  86  85 206 103 158  30 204  51  98 133 112 146  58 142 190  66  38
 189 199 106   0 203  48 164 143 147 153 127   7  12 179 173 115  59   6
  13 155 110 193 162  80 161 137  79 145 185  52 138 169  63  84 132 196
 184 149  46 139  74 166 134 101 191  41 157 198 122  61  57  20  67 194
  26 114 150  42 119  82  33 160 181 148 105 156 197 176 186 118 140  73
  81  93 174 200  28 131 201  36  18 151  83  92 136  34  95 111 172  29
  15  96   1  75 171 120  45  23 168]
train.shape torch.Size([23969, 2, 144, 12]) torch.Size([23969, 12, 144, 1])
val_u.shape torch.Size([3425, 2, 20, 12]) torch.Size([3425, 12, 20, 1])
val_a.shape torch.Size([3425, 2, 165, 12]) torch.Size([3425, 12, 165, 1])
tst_u.shape torch.Size([6844, 2, 41, 12]) torch.Size([6844, 12, 41, 1])
tst_a.shape torch.Size([6844, 2, 207, 12]) torch.Size([6844, 12, 207, 1])
adj_train 2 torch.Size([144, 144]) torch.Size([144, 144])
adj_val_u 2 torch.Size([20, 20]) torch.Size([20, 20])
adj_val_a 2 torch.Size([165, 165]) torch.Size([165, 165])
adj_tst_u 2 torch.Size([41, 41]) torch.Size([41, 41])
adj_tst_a 2 torch.Size([207, 207]) torch.Size([207, 207])
TIMESTEP_IN 12
TIMESTEP_OUT 12
CHANNEL 2
BATCHSIZE 64
LEARN 0.001
PRETRN_EPOCH 50
EPOCH 100
TRAINRATIO 0.8
TRAINVALSPLIT 0.125
ADJTYPE doubletransition
MODELNAME GraphWaveNet
FEATURES 2
SUBGRAPH_SIZE 207
QUOTIENT_GRAPH_RADIUS 0.01
NETWORK_CALLS False
PRE_LEARN 0.0003
GRAPH_NORM False
IS_PRETRN True
R_TRN 0.7
IS_EPOCH_1 False
seed 9
TEMPERATURE 100.0
DATANAME METRLA
seed_SS 9
IS_DESEASONED True
weight_decay 0.0
adp_adj True
is_SGA True
KEYWORD pred_METRLA_GraphWaveNet_2410310825_972032
PATH ../save/pred_METRLA_GraphWaveNet_2410310825_972032
FLOWPATH ../METRLA/metr-la.h5
n_dct_coeff 3918
ADJPATH ../METRLA/adj_mx.pkl
N_NODE 207
trainval_size 27394
train_size 23969
pred_METRLA_GraphWaveNet_2410310825_972032 pretraining started Thu Oct 31 08:25:55 2024
pretrainModel Started ... Thu Oct 31 08:25:55 2024
epoch 0 time used: 5  seconds  train loss: 6.0110442116856575 validation loss: 6.0109710693359375
epoch 1 time used: 4  seconds  train loss: 6.008817099034786 validation loss: 6.010872840881348
epoch 2 time used: 4  seconds  train loss: 6.008678436279297 validation loss: 6.010287761688232
epoch 3 time used: 4  seconds  train loss: 6.008707478642464 validation loss: 6.011538505554199
epoch 4 time used: 4  seconds  train loss: 6.00865363329649 validation loss: 6.011843204498291
epoch 5 time used: 4  seconds  train loss: 6.008635297417641 validation loss: 6.012022018432617
epoch 6 time used: 4  seconds  train loss: 6.0086405500769615 validation loss: 6.011537551879883
epoch 7 time used: 4  seconds  train loss: 6.008622862398624 validation loss: 6.012101650238037
epoch 8 time used: 4  seconds  train loss: 6.008622512221336 validation loss: 6.011733055114746
epoch 9 time used: 4  seconds  train loss: 6.008613832294941 validation loss: 6.011096477508545
epoch 10 time used: 4  seconds  train loss: 6.008623592555523 validation loss: 6.010569095611572
epoch 11 time used: 4  seconds  train loss: 6.008618324995041 validation loss: 6.010504245758057
epoch 12 time used: 4  seconds  train loss: 6.008618086576462 validation loss: 6.010506629943848
epoch 13 time used: 4  seconds  train loss: 6.008610852062702 validation loss: 6.01049280166626
epoch 14 time used: 4  seconds  train loss: 6.0086042657494545 validation loss: 6.010646820068359
epoch 15 time used: 4  seconds  train loss: 6.008601926267147 validation loss: 6.010398197174072
epoch 16 time used: 4  seconds  train loss: 6.008604280650616 validation loss: 6.01053524017334
epoch 17 time used: 4  seconds  train loss: 6.008593931794167 validation loss: 6.010331153869629
epoch 18 time used: 4  seconds  train loss: 6.008596330881119 validation loss: 6.010748386383057
epoch 19 time used: 4  seconds  train loss: 6.0085922703146935 validation loss: 6.010344505310059
epoch 20 time used: 4  seconds  train loss: 6.008592858910561 validation loss: 6.010891437530518
epoch 21 time used: 4  seconds  train loss: 6.008597262203693 validation loss: 6.011168956756592
epoch 22 time used: 4  seconds  train loss: 6.008596695959568 validation loss: 6.011528015136719
epoch 23 time used: 4  seconds  train loss: 6.008591845631599 validation loss: 6.010181903839111
epoch 24 time used: 4  seconds  train loss: 6.008589632809162 validation loss: 6.0107622146606445
epoch 25 time used: 4  seconds  train loss: 6.008591063320637 validation loss: 6.010531425476074
epoch 26 time used: 4  seconds  train loss: 6.008588925004005 validation loss: 6.010400772094727
epoch 27 time used: 4  seconds  train loss: 6.008588016033173 validation loss: 6.010064125061035
epoch 28 time used: 4  seconds  train loss: 6.008594706654549 validation loss: 6.0103654861450195
epoch 29 time used: 4  seconds  train loss: 6.0085911229252815 validation loss: 6.009928226470947
epoch 30 time used: 4  seconds  train loss: 6.008587248623371 validation loss: 6.010183811187744
epoch 31 time used: 4  seconds  train loss: 6.008585959672928 validation loss: 6.00994348526001
epoch 32 time used: 4  seconds  train loss: 6.0085900872945786 validation loss: 6.010400295257568
epoch 33 time used: 4  seconds  train loss: 6.008586637675762 validation loss: 6.010424613952637
epoch 34 time used: 4  seconds  train loss: 6.00858736038208 validation loss: 6.010348796844482
epoch 35 time used: 4  seconds  train loss: 6.008587040007114 validation loss: 6.009954929351807
epoch 36 time used: 4  seconds  train loss: 6.008586376905441 validation loss: 6.009530067443848
epoch 37 time used: 4  seconds  train loss: 6.008586809039116 validation loss: 6.009589195251465
epoch 38 time used: 4  seconds  train loss: 6.008586302399635 validation loss: 6.009913444519043
epoch 39 time used: 4  seconds  train loss: 6.008586101233959 validation loss: 6.009990692138672
epoch 40 time used: 4  seconds  train loss: 6.008585870265961 validation loss: 6.0098724365234375
epoch 41 time used: 4  seconds  train loss: 6.00858548283577 validation loss: 6.009554862976074
epoch 42 time used: 4  seconds  train loss: 6.00858423858881 validation loss: 6.009891510009766
epoch 43 time used: 4  seconds  train loss: 6.008587568998337 validation loss: 6.0096588134765625
epoch 44 time used: 4  seconds  train loss: 6.008584849536419 validation loss: 6.009918880462647
epoch 45 time used: 4  seconds  train loss: 6.008585155010223 validation loss: 6.009790420532227
epoch 46 time used: 4  seconds  train loss: 6.00858398526907 validation loss: 6.009527683258057
epoch 47 time used: 4  seconds  train loss: 6.008585587143898 validation loss: 6.010065078735352
epoch 48 time used: 4  seconds  train loss: 6.008583188056946 validation loss: 6.0096116065979
epoch 49 time used: 4  seconds  train loss: 6.008585251867771 validation loss: 6.00976037979126
PRETIME DURATION: 2024-10-31 08:30:10.502519 - 2024-10-31 08:25:55.769866 = 0:04:14.732653
pretrainModel Ended ... Thu Oct 31 08:30:10 2024
pred_METRLA_GraphWaveNet_2410310825_972032 training started Thu Oct 31 08:30:10 2024
trainModel Started ... Thu Oct 31 08:30:10 2024
TIMESTEP_IN, TIMESTEP_OUT 12 12
Model Training Started ... 2024-10-31 08:30:10.546470
train_embed torch.Size([32, 144]) tensor(0.2165, device='cuda:0') tensor(0.3702, device='cuda:0')
val_u_embed torch.Size([32, 20]) tensor(0.2159, device='cuda:0') tensor(0.4018, device='cuda:0')
val_a_embed torch.Size([32, 165]) tensor(0.2142, device='cuda:0') tensor(0.3675, device='cuda:0')
epoch 0 time used: 44  seconds  train loss: 0.2457196575754341 validation unseen nodes loss: 0.22622369939393372 validation all nodes loss: 0.23228789216410506
epoch 1 time used: 27  seconds  train loss: 0.22076876998952336 validation unseen nodes loss: 0.2310355744266162 validation all nodes loss: 0.2282995088474594
epoch 2 time used: 27  seconds  train loss: 0.2154354530909347 validation unseen nodes loss: 0.22966487767922616 validation all nodes loss: 0.2268132412999216
epoch 3 time used: 27  seconds  train loss: 0.21276913606467496 validation unseen nodes loss: 0.2280685898770381 validation all nodes loss: 0.2308351334037572
epoch 4 time used: 26  seconds  train loss: 0.2089449630674032 validation unseen nodes loss: 0.23558606109479918 validation all nodes loss: 0.22642693074080195
epoch 5 time used: 26  seconds  train loss: 0.20525268079494077 validation unseen nodes loss: 0.23605497368495829 validation all nodes loss: 0.22158650749356207
epoch 6 time used: 27  seconds  train loss: 0.20268796761697191 validation unseen nodes loss: 0.29038514200788346 validation all nodes loss: 0.225044291250027
epoch 7 time used: 26  seconds  train loss: 0.2004533820489932 validation unseen nodes loss: 0.3323351596915809 validation all nodes loss: 0.22439901132653228
epoch 8 time used: 27  seconds  train loss: 0.19812646104246123 validation unseen nodes loss: 0.282419561204249 validation all nodes loss: 0.2240031390860133
epoch 9 time used: 27  seconds  train loss: 0.19704707881810396 validation unseen nodes loss: 0.3273399850008262 validation all nodes loss: 0.22504356821958166
epoch 10 time used: 27  seconds  train loss: 0.1953000904722334 validation unseen nodes loss: 0.29354698788945693 validation all nodes loss: 0.22488256750315647
epoch 11 time used: 27  seconds  train loss: 0.19444528030169972 validation unseen nodes loss: 0.27673570003387704 validation all nodes loss: 0.231563388244079
epoch 12 time used: 26  seconds  train loss: 0.19323214200181196 validation unseen nodes loss: 0.26124241457368336 validation all nodes loss: 0.22799454116038162
epoch 13 time used: 26  seconds  train loss: 0.1922350634657062 validation unseen nodes loss: 0.25601959198495766 validation all nodes loss: 0.22653601506765741
epoch 14 time used: 26  seconds  train loss: 0.19077432347088027 validation unseen nodes loss: 0.25764404156782333 validation all nodes loss: 0.22979266102296592
epoch 15 time used: 26  seconds  train loss: 0.19102511417657364 validation unseen nodes loss: 0.25303026325076167 validation all nodes loss: 0.227305260539925
epoch 16 time used: 26  seconds  train loss: 0.18996496711636102 validation unseen nodes loss: 0.2664470943873816 validation all nodes loss: 0.2308798268285111
epoch 17 time used: 26  seconds  train loss: 0.18836102688848175 validation unseen nodes loss: 0.2667071924897006 validation all nodes loss: 0.22800425498589982
epoch 18 time used: 26  seconds  train loss: 0.18863790024007743 validation unseen nodes loss: 0.27065361803030447 validation all nodes loss: 0.23090601768371832
epoch 19 time used: 26  seconds  train loss: 0.1877503897028814 validation unseen nodes loss: 0.2868335217367994 validation all nodes loss: 0.22902045958668646
epoch 20 time used: 26  seconds  train loss: 0.187396974447642 validation unseen nodes loss: 0.2775258187830013 validation all nodes loss: 0.235729820301933
epoch 21 time used: 26  seconds  train loss: 0.18669148414022776 validation unseen nodes loss: 0.2757429956606705 validation all nodes loss: 0.23541960396035744
epoch 22 time used: 26  seconds  train loss: 0.18619719282898617 validation unseen nodes loss: 0.2748591848794561 validation all nodes loss: 0.23128518725398683
epoch 23 time used: 26  seconds  train loss: 0.18598524632904614 validation unseen nodes loss: 0.2906506325815716 validation all nodes loss: 0.2345938746424487
epoch 24 time used: 26  seconds  train loss: 0.1845641255085288 validation unseen nodes loss: 0.2789618988454777 validation all nodes loss: 0.24331189657214786
epoch 25 time used: 26  seconds  train loss: 0.18467647972803816 validation unseen nodes loss: 0.2800942679565318 validation all nodes loss: 0.23024117717777726
epoch 26 time used: 26  seconds  train loss: 0.18179963563675625 validation unseen nodes loss: 0.2857496412305066 validation all nodes loss: 0.23896215269600388
epoch 27 time used: 26  seconds  train loss: 0.1814590790538064 validation unseen nodes loss: 0.2738187695158659 validation all nodes loss: 0.23610650184380746
epoch 28 time used: 26  seconds  train loss: 0.18191085921441855 validation unseen nodes loss: 0.2747246609682584 validation all nodes loss: 0.23542557929554125
epoch 29 time used: 26  seconds  train loss: 0.18265668937234777 validation unseen nodes loss: 0.27719732852312773 validation all nodes loss: 0.2419639888862624
epoch 30 time used: 26  seconds  train loss: 0.1799202340649317 validation unseen nodes loss: 0.2763751105061413 validation all nodes loss: 0.23954840713608874
epoch 31 time used: 26  seconds  train loss: 0.1798305020990228 validation unseen nodes loss: 0.27877595286734785 validation all nodes loss: 0.2358790520377403
epoch 32 time used: 26  seconds  train loss: 0.17947443031842958 validation unseen nodes loss: 0.2748384555717454 validation all nodes loss: 0.23525973034601141
epoch 33 time used: 27  seconds  train loss: 0.18000222517942835 validation unseen nodes loss: 0.27090659108040105 validation all nodes loss: 0.23705873349287215
epoch 34 time used: 27  seconds  train loss: 0.17721354375581747 validation unseen nodes loss: 0.27476946788982753 validation all nodes loss: 0.23327690808442386
epoch 35 time used: 27  seconds  train loss: 0.17763895165527852 validation unseen nodes loss: 0.2683736280455206 validation all nodes loss: 0.23430923887847985
epoch 36 time used: 26  seconds  train loss: 0.17639489289199242 validation unseen nodes loss: 0.27027317596177985 validation all nodes loss: 0.24196770751998373
epoch 37 time used: 26  seconds  train loss: 0.17643823107820542 validation unseen nodes loss: 0.27727105644497557 validation all nodes loss: 0.24306960831158353
epoch 38 time used: 26  seconds  train loss: 0.1763041598066539 validation unseen nodes loss: 0.27980781215385797 validation all nodes loss: 0.24513303525256414
epoch 39 time used: 26  seconds  train loss: 0.17724987712492407 validation unseen nodes loss: 0.2713676923382891 validation all nodes loss: 0.23527086980586503
epoch 40 time used: 26  seconds  train loss: 0.17620053474506422 validation unseen nodes loss: 0.2706027220243955 validation all nodes loss: 0.2358229728423766
epoch 41 time used: 26  seconds  train loss: 0.17458586732734652 validation unseen nodes loss: 0.2681421000548523 validation all nodes loss: 0.23592059617930086
epoch 42 time used: 26  seconds  train loss: 0.1746132018753234 validation unseen nodes loss: 0.2822164253814377 validation all nodes loss: 0.23847839326319034
epoch 43 time used: 26  seconds  train loss: 0.17461884350568085 validation unseen nodes loss: 0.28153510125884174 validation all nodes loss: 0.2414526069903896
epoch 44 time used: 26  seconds  train loss: 0.1738320207798743 validation unseen nodes loss: 0.30358551053235133 validation all nodes loss: 0.2422933329326393
epoch 45 time used: 26  seconds  train loss: 0.17345335022049585 validation unseen nodes loss: 0.31654409616532986 validation all nodes loss: 0.2488360354152039
epoch 46 time used: 26  seconds  train loss: 0.17433469536572396 validation unseen nodes loss: 0.3383866598571304 validation all nodes loss: 0.23953592249946873
epoch 47 time used: 26  seconds  train loss: 0.1746161088432606 validation unseen nodes loss: 0.37896463564712635 validation all nodes loss: 0.2438292344947801
epoch 48 time used: 26  seconds  train loss: 0.17320468320350305 validation unseen nodes loss: 0.4539409225221968 validation all nodes loss: 0.2550385275417871
epoch 49 time used: 26  seconds  train loss: 0.17324757425603235 validation unseen nodes loss: 0.4390745451328528 validation all nodes loss: 0.31808723522363785
epoch 50 time used: 26  seconds  train loss: 0.17372242316701264 validation unseen nodes loss: 0.7084433103086305 validation all nodes loss: 0.25333389492800634
epoch 51 time used: 26  seconds  train loss: 0.17289368707432237 validation unseen nodes loss: 0.7339578326862224 validation all nodes loss: 0.24445879192682948
epoch 52 time used: 26  seconds  train loss: 0.17385889446239527 validation unseen nodes loss: 0.6659073451966265 validation all nodes loss: 0.2507055261013282
epoch 53 time used: 26  seconds  train loss: 0.17296580035833012 validation unseen nodes loss: 0.43346362158329815 validation all nodes loss: 0.30393750528784563
epoch 54 time used: 26  seconds  train loss: 0.17298976786929202 validation unseen nodes loss: 0.5172416180807309 validation all nodes loss: 0.24706749359186547
epoch 55 time used: 26  seconds  train loss: 0.17028989282063775 validation unseen nodes loss: 0.7543782553577075 validation all nodes loss: 0.2690032711733867
epoch 56 time used: 26  seconds  train loss: 0.17090733118802576 validation unseen nodes loss: 0.31356545579694484 validation all nodes loss: 0.24800553081244447
epoch 57 time used: 26  seconds  train loss: 0.17065778651010796 validation unseen nodes loss: 0.3963103505207674 validation all nodes loss: 0.24914704002603127
epoch 58 time used: 26  seconds  train loss: 0.17069858214069783 validation unseen nodes loss: 0.45178018197526026 validation all nodes loss: 0.3558539361588276
epoch 59 time used: 26  seconds  train loss: 0.16654289028694694 validation unseen nodes loss: 0.4779173189880204 validation all nodes loss: 0.41853070186872554
epoch 60 time used: 26  seconds  train loss: 0.16887135618996962 validation unseen nodes loss: 0.4201734600537015 validation all nodes loss: 0.4941206284422074
epoch 61 time used: 26  seconds  train loss: 0.16676467452181948 validation unseen nodes loss: 0.33919428571297305 validation all nodes loss: 0.29865858704939374
epoch 62 time used: 26  seconds  train loss: 0.16596779438443077 validation unseen nodes loss: 0.43410854247364683 validation all nodes loss: 0.2807590490623112
epoch 63 time used: 26  seconds  train loss: 0.16588391864139132 validation unseen nodes loss: 0.4163990912950822 validation all nodes loss: 0.2506629881110505
epoch 64 time used: 26  seconds  train loss: 0.16564037902512654 validation unseen nodes loss: 0.5063778711322451 validation all nodes loss: 0.3524487650698989
epoch 65 time used: 26  seconds  train loss: 0.16825274399167492 validation unseen nodes loss: 0.8322874290708208 validation all nodes loss: 0.26121151797092745
epoch 66 time used: 26  seconds  train loss: 0.16412962257993888 validation unseen nodes loss: 0.5237420310591259 validation all nodes loss: 0.4204496993635693
epoch 67 time used: 26  seconds  train loss: 0.16303208079988704 validation unseen nodes loss: 0.5520791644510562 validation all nodes loss: 0.4605136144030703
epoch 68 time used: 26  seconds  train loss: 0.16221270394818127 validation unseen nodes loss: 0.8813155566471337 validation all nodes loss: 0.4345036819250914
epoch 69 time used: 26  seconds  train loss: 0.16709232861614032 validation unseen nodes loss: 0.5545337527076694 validation all nodes loss: 0.2897262683010449
epoch 70 time used: 26  seconds  train loss: 0.16408851228424673 validation unseen nodes loss: 0.5418656461691335 validation all nodes loss: 0.37773791344061386
epoch 71 time used: 26  seconds  train loss: 0.16123744984399024 validation unseen nodes loss: 0.3849509678791909 validation all nodes loss: 0.9698546086958725
epoch 72 time used: 26  seconds  train loss: 0.16091710564736467 validation unseen nodes loss: 0.4980856787462304 validation all nodes loss: 0.3567471322613041
epoch 73 time used: 26  seconds  train loss: 0.16023059051492106 validation unseen nodes loss: 0.6058368069716613 validation all nodes loss: 0.24766606691980014
epoch 74 time used: 26  seconds  train loss: 0.16432440694148143 validation unseen nodes loss: 0.7359430618442758 validation all nodes loss: 0.25267226710371726
epoch 75 time used: 26  seconds  train loss: 0.16559179179997371 validation unseen nodes loss: 0.7852977853708893 validation all nodes loss: 0.43411822293796676
epoch 76 time used: 26  seconds  train loss: 0.16017746021051402 validation unseen nodes loss: 0.7633706677917146 validation all nodes loss: 0.47906196208765905
epoch 77 time used: 26  seconds  train loss: 0.15972034941515262 validation unseen nodes loss: 0.9197453171493363 validation all nodes loss: 0.4894885440290409
epoch 78 time used: 26  seconds  train loss: 0.15908622566757136 validation unseen nodes loss: 0.7219778000916878 validation all nodes loss: 0.32344123430060645
epoch 79 time used: 26  seconds  train loss: 0.16109367173757705 validation unseen nodes loss: 0.4540788912599104 validation all nodes loss: 0.2974591659150855
epoch 80 time used: 26  seconds  train loss: 0.1601020372175266 validation unseen nodes loss: 0.4959606144767608 validation all nodes loss: 0.2844078583699943
epoch 81 time used: 26  seconds  train loss: 0.15822445035958063 validation unseen nodes loss: 0.5183406947651049 validation all nodes loss: 0.40988859133998845
epoch 82 time used: 26  seconds  train loss: 0.15917170202994685 validation unseen nodes loss: 0.7800035670638955 validation all nodes loss: 0.2616034477427058
epoch 83 time used: 26  seconds  train loss: 0.15854971056609862 validation unseen nodes loss: 0.50650089572816 validation all nodes loss: 0.3433942954296613
epoch 84 time used: 26  seconds  train loss: 0.1689090474845073 validation unseen nodes loss: 0.7916430831564604 validation all nodes loss: 0.25592792192949865
epoch 85 time used: 26  seconds  train loss: 0.1590897972612418 validation unseen nodes loss: 0.795697772533354 validation all nodes loss: 0.34983515995697384
epoch 86 time used: 26  seconds  train loss: 0.1579771322026122 validation unseen nodes loss: 0.9945826697436563 validation all nodes loss: 0.2750077240049404
epoch 87 time used: 26  seconds  train loss: 0.15760546782991158 validation unseen nodes loss: 0.7725018385988083 validation all nodes loss: 0.24910507491035183
epoch 88 time used: 26  seconds  train loss: 0.15815923951115188 validation unseen nodes loss: 0.9317381307722008 validation all nodes loss: 0.36983054054044456
epoch 89 time used: 26  seconds  train loss: 0.1565653881235044 validation unseen nodes loss: 0.786704591704111 validation all nodes loss: 0.3473479734981147
epoch 90 time used: 26  seconds  train loss: 0.1580589710696279 validation unseen nodes loss: 0.950157242734937 validation all nodes loss: 0.31460170294246537
epoch 91 time used: 26  seconds  train loss: 0.15692136038294163 validation unseen nodes loss: 0.9964389516228307 validation all nodes loss: 0.349764653696631
epoch 92 time used: 26  seconds  train loss: 0.15713809509491003 validation unseen nodes loss: 0.6707336435135264 validation all nodes loss: 0.3784202951323377
epoch 93 time used: 26  seconds  train loss: 0.15823998842620746 validation unseen nodes loss: 0.87794027506435 validation all nodes loss: 0.42666961594219627
epoch 94 time used: 26  seconds  train loss: 0.16043177307599515 validation unseen nodes loss: 1.4249738054989027 validation all nodes loss: 0.24868057917939485
epoch 95 time used: 26  seconds  train loss: 0.167321492214516 validation unseen nodes loss: 0.7477138000248122 validation all nodes loss: 0.23978176413226301
epoch 96 time used: 26  seconds  train loss: 0.15716536918715573 validation unseen nodes loss: 0.5797023722681686 validation all nodes loss: 0.2519742089379443
epoch 97 time used: 26  seconds  train loss: 0.15588721166942587 validation unseen nodes loss: 0.7208111749078235 validation all nodes loss: 0.25731935255283855
epoch 98 time used: 26  seconds  train loss: 0.15684506554737662 validation unseen nodes loss: 0.5696156117298308 validation all nodes loss: 0.26870295564188573
epoch 99 time used: 26  seconds  train loss: 0.15542809991587575 validation unseen nodes loss: 0.6665343539993258 validation all nodes loss: 0.2863101307754099
MODEL TRAINING DURATION: 2024-10-31 09:15:31.189254 - 2024-10-31 08:30:10.546470 = 0:45:20.642784
****************************************
GraphWaveNet, train, MAE on train, 1.5383146593e-01, 0.1538314659
min_val_u_loss 0.22622369939393372
min_val_a_loss 0.22158650749356207
trainModel Ended ... Thu Oct 31 09:15:40 2024
pred_METRLA_GraphWaveNet_2410310825_972032 testing started Thu Oct 31 09:15:40 2024
Model Testing test_u Started ... Thu Oct 31 09:15:40 2024
TIMESTEP_IN, TIMESTEP_OUT 12 12
Model Infer Start ... 2024-10-31 09:15:40.188540
Model Infer End ... 2024-10-31 09:15:47.910108
MODEL INFER DURATION: 2024-10-31 09:15:47.910108 - 2024-10-31 09:15:40.188540 = 0:00:07.721568
YS.shape, YS_pred.shape, (6844, 12, 41, 1) (6844, 12, 41, 1)
YS.shape, YS_pred.shape, (6844, 12, 41) (6844, 12, 41)
****************************************
GraphWaveNet, test_u, Torch MSE, 2.7085649314e-01, 0.2708564931
all pred steps, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 107.2977447510, 10.3584623337, 4.8940577507, 13.0686551332
1 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 33.9318008423, 5.8251008987, 2.9370703697, 7.1592696011
2 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 50.2797584534, 7.0908222198, 3.4168906212, 8.7126910686
3 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 63.8879547119, 7.9929943085, 3.8161990643, 9.9251091480
4 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 78.4721603394, 8.8584508896, 4.1377511024, 10.6474444270
5 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 92.8819808960, 9.6375293732, 4.5051698685, 11.8159331381
6 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 106.3208465576, 10.3112001419, 4.8979282379, 13.0704134703
7 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 118.6580886841, 10.8930292130, 5.2015442848, 13.9069497585
8 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 130.0761718750, 11.4050941467, 5.4384374619, 14.6510884166
9 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 135.7665252686, 11.6518898010, 5.6744251251, 15.4909670353
10 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 152.5278778076, 12.3502178192, 6.0094056129, 16.2914305925
11 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 159.9830322266, 12.6484403610, 6.2225627899, 17.0785486698
12 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 164.8008422852, 12.8374776840, 6.4716715813, 18.0751472712
Model Testing Ended ... Thu Oct 31 09:15:50 2024
Model Testing test_a Started ... Thu Oct 31 09:15:50 2024
TIMESTEP_IN, TIMESTEP_OUT 12 12
Model Infer Start ... 2024-10-31 09:15:50.443660
Model Infer End ... 2024-10-31 09:16:00.719878
MODEL INFER DURATION: 2024-10-31 09:16:00.719878 - 2024-10-31 09:15:50.443660 = 0:00:10.276218
YS.shape, YS_pred.shape, (6844, 12, 207, 1) (6844, 12, 207, 1)
YS.shape, YS_pred.shape, (6844, 12, 207) (6844, 12, 207)
****************************************
GraphWaveNet, test_a, Torch MSE, 2.5968408879e-01, 0.2596840888
all pred steps, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 107.3636779785, 10.3616447449, 4.6706852913, 13.1441786885
1 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 31.1530017853, 5.5814871788, 2.7458374500, 6.6184513271
2 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 47.7936134338, 6.9132924080, 3.2325887680, 8.1075474620
3 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 62.5977478027, 7.9118738174, 3.6152968407, 9.3758262694
4 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 78.0329360962, 8.8336248398, 3.9902365208, 10.6844089925
5 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 92.8195037842, 9.6342878342, 4.3474683762, 11.9323782623
6 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 105.7359924316, 10.2828006744, 4.6751618385, 13.1328672171
7 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 119.6594467163, 10.9388961792, 4.9697499275, 14.0368670225
8 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 130.5858917236, 11.4274187088, 5.2407360077, 15.1134669781
9 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 140.4198303223, 11.8498868942, 5.4796423912, 16.0553246737
10 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 149.9305877686, 12.2446146011, 5.7053232193, 16.8432116508
11 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 160.2003326416, 12.6570272446, 5.9280347824, 17.6734805107
12 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 169.4444427490, 13.0170831680, 6.1183047295, 18.1571498513
Model Testing Ended ... Thu Oct 31 09:16:08 2024
SCRIPT DURATION 0:50:24.986156

======================================================================================
                  Resource Usage on 2024-10-31 09:16:15:
   Job Id:             127921552.gadi-pbs
   Project:            hn98
   Exit Status:        0
   Service Units:      31.88
   NCPUs Requested:    12                     NCPUs Used: 12              
                                           CPU Time Used: 00:49:59        
   Memory Requested:   8.0GB                 Memory Used: 4.87GB          
   NGPUs Requested:    1                 GPU Utilisation: 47%             
                                         GPU Memory Used: 2.32GB          
   Walltime requested: 03:00:00            Walltime Used: 00:53:08        
   JobFS requested:    100.0MB                JobFS used: 17.52KB         
======================================================================================
