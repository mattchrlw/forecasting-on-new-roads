Package                  Version
------------------------ -----------
aiohappyeyeballs         2.4.3
aiohttp                  3.10.10
aiosignal                1.3.1
async-timeout            4.0.3
attrs                    24.2.0
blosc2                   2.5.1
certifi                  2024.8.30
charset-normalizer       3.4.0
click                    8.1.7
click-plugins            1.1.1
cligj                    0.7.2
contourpy                1.3.0
cycler                   0.12.1
filelock                 3.16.1
fiona                    1.10.1
fonttools                4.54.1
frozenlist               1.5.0
fsspec                   2024.10.0
geopandas                0.14.4
idna                     3.10
importlib-metadata       8.5.0
importlib-resources      6.4.5
jinja2                   3.1.4
joblib                   1.4.2
kiwisolver               1.4.7
MarkupSafe               3.0.2
matplotlib               3.9.2
mpmath                   1.3.0
msgpack                  1.1.0
multidict                6.1.0
ndindex                  1.9.2
networkx                 3.2.1
numexpr                  2.10.1
numpy                    1.26.4
nvidia-cublas-cu12       12.4.5.8
nvidia-cuda-cupti-cu12   12.4.127
nvidia-cuda-nvrtc-cu12   12.4.127
nvidia-cuda-runtime-cu12 12.4.127
nvidia-cudnn-cu12        9.1.0.70
nvidia-cufft-cu12        11.2.1.3
nvidia-curand-cu12       10.3.5.147
nvidia-cusolver-cu12     11.6.1.9
nvidia-cusparse-cu12     12.3.1.170
nvidia-nccl-cu12         2.21.5
nvidia-nvjitlink-cu12    12.4.127
nvidia-nvtx-cu12         12.4.127
osmnx                    1.9.4
packaging                24.1
pandas                   2.2.3
pillow                   11.0.0
pip                      20.2.3
propcache                0.2.0
psutil                   6.1.0
py-cpuinfo               9.0.0
pyparsing                3.2.0
pyproj                   3.6.1
python-dateutil          2.9.0.post0
pytz                     2024.2
requests                 2.32.3
scikit-learn             1.5.2
scipy                    1.13.1
setuptools               49.2.1
shapely                  2.0.6
six                      1.16.0
sympy                    1.13.1
tables                   3.9.2
threadpoolctl            3.5.0
torch                    2.5.0
torch-geometric          2.6.1
torchaudio               2.5.0
torchvision              0.20.0
tqdm                     4.66.5
triton                   3.1.0
typing-extensions        4.12.2
tzdata                   2024.2
urllib3                  2.2.3
yarl                     1.16.0
zipp                     3.20.2
/g/data/hn98/matt/forecasting-on-new-roads
Thu Oct 31 08:24:10 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-SXM2-32GB           On  |   00000000:B2:00.0 Off |                    0 |
| N/A   32C    P0             42W /  300W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Architecture:        x86_64
CPU op-mode(s):      32-bit, 64-bit
Byte Order:          Little Endian
CPU(s):              96
On-line CPU(s) list: 0-95
Thread(s) per core:  2
Core(s) per socket:  24
Socket(s):           2
NUMA node(s):        4
Vendor ID:           GenuineIntel
CPU family:          6
Model:               85
Model name:          Intel(R) Xeon(R) Platinum 8268 CPU @ 2.90GHz
Stepping:            7
CPU MHz:             2900.000
CPU max MHz:         3900.0000
CPU min MHz:         1200.0000
BogoMIPS:            5800.00
L1d cache:           32K
L1i cache:           32K
L2 cache:            1024K
L3 cache:            36608K
NUMA node0 CPU(s):   0-3,6-8,12-14,19,20,48-51,54-56,60-62,67,68
NUMA node1 CPU(s):   4,5,9-11,15-18,21-23,52,53,57-59,63-66,69-71
NUMA node2 CPU(s):   24-27,31,32,36-38,42-44,72-75,79,80,84-86,90-92
NUMA node3 CPU(s):   28-30,33-35,39-41,45-47,76-78,81-83,87-89,93-95
Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 cdp_l3 invpcid_single intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm mpx rdt_a avx512f avx512dq rdseed adx smap clflushopt clwb intel_pt avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local dtherm ida arat pln pts hwp hwp_act_window hwp_epp hwp_pkg_req pku ospke avx512_vnni md_clear flush_l1d arch_capabilities
sys.argv ['./pred_GWN_16_adpAdj.py', '1', '0.7', '0', '10', '100', 'METRLA', '10', '1', '0.0', '1', '1', '2', '207', '0.01', '50', '100', '0', '0.0003', '0']
P.DATANAME == METRLA
data.shape (34272, 207)
pred_METRLA_GraphWaveNet_2410310825_972329 data splits Thu Oct 31 08:25:50 2024
spatialSplit_unseen all: trn/val/tst : 207 : 144 / 20 / 41
[ 58  63  35  19  59  56  83 105 121  76 205 132   5  55  78 117  70  46
 142   1   2 102  10 193  49   6  39 130  20 134 103  87  75 180  60 148
 199  69 201 168 167 172 181  52  99  98  47 175 182 111 147 161 155 197
   7  26 192 160  61 110 206  68 116  24  43 144  21 129 114  91  72 163
 124  67  66  22  38 203 119 166 106 101  90 131 171 127  41  80  81  32
  95  48  25  53 128  17 120  51  14  82  84 191  29   3  23 152 195  37
 196 169 194  45 136  97 186 185 109  42 174 146  79 198 165 170 184 143
 173  12 112  11  85 154 176 104  34 108  50 138 149 159   4 133  44  96]
[166   1 147 179 192 160  98  66  53 170  47 187  77 197  43  67 188   4
  84  24]
[ 69  27  39 199  66  73  44  79 152 142  49 123  37 110  67 185  30  64
 172  13  53 135 194  62 143  35  52 179  97 151 170 192  76  92 145  45
  75  33  22  38 161]
spatialSplit_allNod all: trn/val/tst : 207 : 144 / 165 / 207
[ 58  63  35  19  59  56  83 105 121  76 205 132   5  55  78 117  70  46
 142   1   2 102  10 193  49   6  39 130  20 134 103  87  75 180  60 148
 199  69 201 168 167 172 181  52  99  98  47 175 182 111 147 161 155 197
   7  26 192 160  61 110 206  68 116  24  43 144  21 129 114  91  72 163
 124  67  66  22  38 203 119 166 106 101  90 131 171 127  41  80  81  32
  95  48  25  53 128  17 120  51  14  82  84 191  29   3  23 152 195  37
 196 169 194  45 136  97 186 185 109  42 174 146  79 198 165 170 184 143
 173  12 112  11  85 154 176 104  34 108  50 138 149 159   4 133  44  96]
[166   1 147 179 192 160  98  66  53 170  47 187  77 197  43  67 188   4
  84  24  95 164  78 158 201 162  22 173  72 111 128 113   8 146 185   6
 116  26 110 178  15  97 196  90  73 118 189  37  88 133 102 202 183  12
 100  56  99 101  33 125  61 205  94  45  65  46 175  28  31 119  74 109
 171  23  82 136  52  81 193 172  64  27  48 122 203 130 181 105 176 200
 115 156  16  91  69 131 168  10  76 199  34 161  80  57  87 184  93   7
 126 142  92  71 169  29  86 123  70 121  17  30   2  59 114 204  25  96
 140 153  89  20 198 135 124  13 163  32 152  62 191  36 138 154 151  54
  41  11 182 149 120  35  85  19 150 186 177 108   5 180  51 157 145 159
   3 104 141]
[ 69  27  39 199  66  73  44  79 152 142  49 123  37 110  67 185  30  64
 172  13  53 135 194  62 143  35  52 179  97 151 170 192  76  92 145  45
  75  33  22  38 161   9  14 112 148 195 186  31 127 176 108 190  24 159
  90 157  93 124 105 102  20  16 101 165  55 150  36  51  41  15 140  68
 120  17  34 178 138  47 204  32  78 173  18  21  42  48  43 167   7  65
 104 133  84  57 200  72   8  54 181 171 106 100 188 153  87  85   6 202
 180 125  29 163 158 168  19 131 132 196 175   0 113 115  86  99  12   1
   5 169  26 109 116 128 137   4  95  40 177 201  56 193   2 107 121  70
  81 111 182 191  25  77 141 189 130  91 198  94 160 156 118  80 154  88
 117 136 187  96 114 147  82 174  89  98 155 166 183  71  83 126 184 122
 205 146 103 144 149 197  59  50   3  60  63 134 164  74  46 139 119 162
 203  11 206  58  28 129  23  61  10]
train.shape torch.Size([23969, 2, 144, 12]) torch.Size([23969, 12, 144, 1])
val_u.shape torch.Size([3425, 2, 20, 12]) torch.Size([3425, 12, 20, 1])
val_a.shape torch.Size([3425, 2, 165, 12]) torch.Size([3425, 12, 165, 1])
tst_u.shape torch.Size([6844, 2, 41, 12]) torch.Size([6844, 12, 41, 1])
tst_a.shape torch.Size([6844, 2, 207, 12]) torch.Size([6844, 12, 207, 1])
adj_train 2 torch.Size([144, 144]) torch.Size([144, 144])
adj_val_u 2 torch.Size([20, 20]) torch.Size([20, 20])
adj_val_a 2 torch.Size([165, 165]) torch.Size([165, 165])
adj_tst_u 2 torch.Size([41, 41]) torch.Size([41, 41])
adj_tst_a 2 torch.Size([207, 207]) torch.Size([207, 207])
TIMESTEP_IN 12
TIMESTEP_OUT 12
CHANNEL 2
BATCHSIZE 64
LEARN 0.001
PRETRN_EPOCH 50
EPOCH 100
TRAINRATIO 0.8
TRAINVALSPLIT 0.125
ADJTYPE doubletransition
MODELNAME GraphWaveNet
FEATURES 2
SUBGRAPH_SIZE 207
QUOTIENT_GRAPH_RADIUS 0.01
NETWORK_CALLS False
PRE_LEARN 0.0003
GRAPH_NORM False
IS_PRETRN True
R_TRN 0.7
IS_EPOCH_1 False
seed 10
TEMPERATURE 100.0
DATANAME METRLA
seed_SS 10
IS_DESEASONED True
weight_decay 0.0
adp_adj True
is_SGA True
KEYWORD pred_METRLA_GraphWaveNet_2410310825_972329
PATH ../save/pred_METRLA_GraphWaveNet_2410310825_972329
FLOWPATH ../METRLA/metr-la.h5
n_dct_coeff 3918
ADJPATH ../METRLA/adj_mx.pkl
N_NODE 207
trainval_size 27394
train_size 23969
pred_METRLA_GraphWaveNet_2410310825_972329 pretraining started Thu Oct 31 08:25:55 2024
pretrainModel Started ... Thu Oct 31 08:25:55 2024
epoch 0 time used: 5  seconds  train loss: 6.011274442076683 validation loss: 6.011188507080078
epoch 1 time used: 5  seconds  train loss: 6.008736714720726 validation loss: 6.010424613952637
epoch 2 time used: 4  seconds  train loss: 6.008658729493618 validation loss: 6.010260105133057
epoch 3 time used: 4  seconds  train loss: 6.00863490998745 validation loss: 6.011361598968506
epoch 4 time used: 4  seconds  train loss: 6.0086511597037315 validation loss: 6.01102352142334
epoch 5 time used: 4  seconds  train loss: 6.008612014353275 validation loss: 6.010378837585449
epoch 6 time used: 5  seconds  train loss: 6.008599303662777 validation loss: 6.010185241699219
epoch 7 time used: 4  seconds  train loss: 6.008627496659756 validation loss: 6.0107741355896
epoch 8 time used: 4  seconds  train loss: 6.0086095705628395 validation loss: 6.01054573059082
epoch 9 time used: 4  seconds  train loss: 6.008604824542999 validation loss: 6.010217189788818
epoch 10 time used: 4  seconds  train loss: 6.008603923022747 validation loss: 6.010050296783447
epoch 11 time used: 5  seconds  train loss: 6.0085974633693695 validation loss: 6.010497093200684
epoch 12 time used: 4  seconds  train loss: 6.0085922703146935 validation loss: 6.010051250457764
epoch 13 time used: 4  seconds  train loss: 6.008596785366535 validation loss: 6.010116100311279
epoch 14 time used: 4  seconds  train loss: 6.008590020239353 validation loss: 6.010172367095947
epoch 15 time used: 4  seconds  train loss: 6.008589759469032 validation loss: 6.010040760040283
epoch 16 time used: 5  seconds  train loss: 6.0085951164364815 validation loss: 6.009750843048096
epoch 17 time used: 4  seconds  train loss: 6.008590295910835 validation loss: 6.010083198547363
epoch 18 time used: 4  seconds  train loss: 6.00859072804451 validation loss: 6.00986385345459
epoch 19 time used: 4  seconds  train loss: 6.008588261902332 validation loss: 6.009771823883057
epoch 20 time used: 4  seconds  train loss: 6.008589059114456 validation loss: 6.009852409362793
epoch 21 time used: 4  seconds  train loss: 6.008590035140514 validation loss: 6.009847640991211
epoch 22 time used: 4  seconds  train loss: 6.008587032556534 validation loss: 6.010023593902588
epoch 23 time used: 4  seconds  train loss: 6.008592717349529 validation loss: 6.009727954864502
epoch 24 time used: 4  seconds  train loss: 6.008588090538979 validation loss: 6.010156631469727
epoch 25 time used: 4  seconds  train loss: 6.008586451411247 validation loss: 6.010473251342773
epoch 26 time used: 4  seconds  train loss: 6.008587449789047 validation loss: 6.0105109214782715
epoch 27 time used: 4  seconds  train loss: 6.00858673453331 validation loss: 6.010688304901123
epoch 28 time used: 4  seconds  train loss: 6.008586905896664 validation loss: 6.009868144989014
epoch 29 time used: 4  seconds  train loss: 6.008587516844273 validation loss: 6.009741306304932
epoch 30 time used: 4  seconds  train loss: 6.008589141070843 validation loss: 6.009738922119141
epoch 31 time used: 4  seconds  train loss: 6.008586600422859 validation loss: 6.009794235229492
epoch 32 time used: 4  seconds  train loss: 6.008586451411247 validation loss: 6.009655475616455
epoch 33 time used: 4  seconds  train loss: 6.008584663271904 validation loss: 6.009628772735596
epoch 34 time used: 4  seconds  train loss: 6.008585691452026 validation loss: 6.0101118087768555
epoch 35 time used: 4  seconds  train loss: 6.008584082126617 validation loss: 6.009980201721191
epoch 36 time used: 5  seconds  train loss: 6.008583791553974 validation loss: 6.0094218254089355
epoch 37 time used: 4  seconds  train loss: 6.0085840448737144 validation loss: 6.0097432136535645
epoch 38 time used: 4  seconds  train loss: 6.0085818618535995 validation loss: 6.009896278381348
epoch 39 time used: 4  seconds  train loss: 6.008582219481468 validation loss: 6.0099639892578125
epoch 40 time used: 4  seconds  train loss: 6.008582524955273 validation loss: 6.0097832679748535
epoch 41 time used: 4  seconds  train loss: 6.008582383394241 validation loss: 6.009897232055664
epoch 42 time used: 4  seconds  train loss: 6.008582688868046 validation loss: 6.009584426879883
epoch 43 time used: 4  seconds  train loss: 6.0085824355483055 validation loss: 6.0097975730896
epoch 44 time used: 4  seconds  train loss: 6.0085815861821175 validation loss: 6.009846210479736
epoch 45 time used: 4  seconds  train loss: 6.00858199596405 validation loss: 6.009523868560791
epoch 46 time used: 4  seconds  train loss: 6.008581712841988 validation loss: 6.00975227355957
epoch 47 time used: 4  seconds  train loss: 6.008581534028053 validation loss: 6.009560585021973
epoch 48 time used: 4  seconds  train loss: 6.008580818772316 validation loss: 6.009899139404297
epoch 49 time used: 4  seconds  train loss: 6.008580029010773 validation loss: 6.010034561157227
PRETIME DURATION: 2024-10-31 08:30:17.518077 - 2024-10-31 08:25:55.769738 = 0:04:21.748339
pretrainModel Ended ... Thu Oct 31 08:30:17 2024
pred_METRLA_GraphWaveNet_2410310825_972329 training started Thu Oct 31 08:30:17 2024
trainModel Started ... Thu Oct 31 08:30:17 2024
TIMESTEP_IN, TIMESTEP_OUT 12 12
Model Training Started ... 2024-10-31 08:30:17.562789
train_embed torch.Size([32, 144]) tensor(0.2064, device='cuda:0') tensor(0.3215, device='cuda:0')
val_u_embed torch.Size([32, 20]) tensor(0.2312, device='cuda:0') tensor(0.3457, device='cuda:0')
val_a_embed torch.Size([32, 165]) tensor(0.1988, device='cuda:0') tensor(0.2983, device='cuda:0')
epoch 0 time used: 43  seconds  train loss: 0.24830559327638296 validation unseen nodes loss: 0.27745403031363103 validation all nodes loss: 0.2216327526752096
epoch 1 time used: 28  seconds  train loss: 0.22646600539551304 validation unseen nodes loss: 0.27865407600890113 validation all nodes loss: 0.21887608952330848
epoch 2 time used: 26  seconds  train loss: 0.22030706281476775 validation unseen nodes loss: 0.3181218819287572 validation all nodes loss: 0.22145084324109293
epoch 3 time used: 26  seconds  train loss: 0.21746015722466935 validation unseen nodes loss: 0.2826498321025041 validation all nodes loss: 0.22228336283325278
epoch 4 time used: 26  seconds  train loss: 0.21363662129695535 validation unseen nodes loss: 0.3338685820920624 validation all nodes loss: 0.2257022381481463
epoch 5 time used: 26  seconds  train loss: 0.21149595553043204 validation unseen nodes loss: 0.30076855657744583 validation all nodes loss: 0.22242340921485512
epoch 6 time used: 26  seconds  train loss: 0.20804678724462536 validation unseen nodes loss: 0.2755773999525683 validation all nodes loss: 0.2383163194847803
epoch 7 time used: 26  seconds  train loss: 0.20674309251546572 validation unseen nodes loss: 0.2917867492150216 validation all nodes loss: 0.2455600484226742
epoch 8 time used: 26  seconds  train loss: 0.2047370730272655 validation unseen nodes loss: 0.2773720077572078 validation all nodes loss: 0.2435847042903413
epoch 9 time used: 26  seconds  train loss: 0.2032680692614888 validation unseen nodes loss: 0.3251550252420189 validation all nodes loss: 0.23800163670177876
epoch 10 time used: 26  seconds  train loss: 0.20087760559491188 validation unseen nodes loss: 0.26694095679443247 validation all nodes loss: 0.23742244126152817
epoch 11 time used: 26  seconds  train loss: 0.1996200886025457 validation unseen nodes loss: 0.2805503279492803 validation all nodes loss: 0.24595519264249036
epoch 12 time used: 26  seconds  train loss: 0.19875171095800517 validation unseen nodes loss: 0.28130265686633815 validation all nodes loss: 0.23629475775861392
epoch 13 time used: 26  seconds  train loss: 0.197895719125824 validation unseen nodes loss: 0.269746212276229 validation all nodes loss: 0.25108946211581684
epoch 14 time used: 26  seconds  train loss: 0.1965959910044578 validation unseen nodes loss: 0.2755334139827394 validation all nodes loss: 0.24508108413132437
epoch 15 time used: 26  seconds  train loss: 0.1957780420742881 validation unseen nodes loss: 0.27516344588168345 validation all nodes loss: 0.25387221258922216
epoch 16 time used: 26  seconds  train loss: 0.1956555435789199 validation unseen nodes loss: 0.27608600363679175 validation all nodes loss: 0.2520424558515966
epoch 17 time used: 26  seconds  train loss: 0.1943334158186849 validation unseen nodes loss: 0.29417634432768297 validation all nodes loss: 0.26517047789845155
epoch 18 time used: 26  seconds  train loss: 0.1941557288961887 validation unseen nodes loss: 0.29026548868548263 validation all nodes loss: 0.26224638687433116
epoch 19 time used: 26  seconds  train loss: 0.19318075269128698 validation unseen nodes loss: 0.29296716698764885 validation all nodes loss: 0.2585083140552479
epoch 20 time used: 26  seconds  train loss: 0.19342680039946042 validation unseen nodes loss: 0.2924981659041704 validation all nodes loss: 0.2588587843632176
epoch 21 time used: 26  seconds  train loss: 0.19181393810240427 validation unseen nodes loss: 0.3009630954787679 validation all nodes loss: 0.2635018566794639
epoch 22 time used: 26  seconds  train loss: 0.19310034076478882 validation unseen nodes loss: 0.27535384422236114 validation all nodes loss: 0.24669336947211384
epoch 23 time used: 26  seconds  train loss: 0.19147199426635722 validation unseen nodes loss: 0.29962505092586045 validation all nodes loss: 0.2502764878786393
epoch 24 time used: 26  seconds  train loss: 0.19077430889734692 validation unseen nodes loss: 0.28790166259682093 validation all nodes loss: 0.24813586264196102
epoch 25 time used: 26  seconds  train loss: 0.18970462354038012 validation unseen nodes loss: 0.30176869045208843 validation all nodes loss: 0.25080151540954615
epoch 26 time used: 26  seconds  train loss: 0.18970727772819937 validation unseen nodes loss: 0.29085853544900014 validation all nodes loss: 0.2485591088115734
epoch 27 time used: 26  seconds  train loss: 0.18900735718936176 validation unseen nodes loss: 0.28375578983421745 validation all nodes loss: 0.2523950579653691
epoch 28 time used: 26  seconds  train loss: 0.18740602489036295 validation unseen nodes loss: 0.2755407057495883 validation all nodes loss: 0.24639407846614392
epoch 29 time used: 26  seconds  train loss: 0.18764196417399234 validation unseen nodes loss: 0.26984991937658215 validation all nodes loss: 0.2533826168827767
epoch 30 time used: 26  seconds  train loss: 0.18745861661001978 validation unseen nodes loss: 0.28864648687578465 validation all nodes loss: 0.24432123507896478
epoch 31 time used: 26  seconds  train loss: 0.18660323875678228 validation unseen nodes loss: 0.2924045840884647 validation all nodes loss: 0.2574513463991402
epoch 32 time used: 26  seconds  train loss: 0.1861910429962327 validation unseen nodes loss: 0.2864357125150026 validation all nodes loss: 0.24934360458903068
epoch 33 time used: 26  seconds  train loss: 0.18701309663088908 validation unseen nodes loss: 0.26970856888885913 validation all nodes loss: 0.24992963062150636
epoch 34 time used: 26  seconds  train loss: 0.18446471150862698 validation unseen nodes loss: 0.3165298321125281 validation all nodes loss: 0.26232576508156574
epoch 35 time used: 26  seconds  train loss: 0.183207654702837 validation unseen nodes loss: 0.43396675907782395 validation all nodes loss: 0.2633892717283138
epoch 36 time used: 26  seconds  train loss: 0.18343014545566802 validation unseen nodes loss: 0.271070462748082 validation all nodes loss: 0.2523297377354907
epoch 37 time used: 26  seconds  train loss: 0.18227128480545962 validation unseen nodes loss: 1.681886769037177 validation all nodes loss: 0.29115280182692255
epoch 38 time used: 26  seconds  train loss: 0.1834127626620891 validation unseen nodes loss: 1.0005116443912478 validation all nodes loss: 0.25949862045093175
epoch 39 time used: 26  seconds  train loss: 0.18392070090548407 validation unseen nodes loss: 0.8453618379230917 validation all nodes loss: 0.2638011510311252
epoch 40 time used: 26  seconds  train loss: 0.18103208378031324 validation unseen nodes loss: 1.5947753089709873 validation all nodes loss: 0.2647679651175102
epoch 41 time used: 26  seconds  train loss: 0.17902466834817424 validation unseen nodes loss: 0.6605664496178174 validation all nodes loss: 0.25233206266469327
epoch 42 time used: 26  seconds  train loss: 0.18115147699342513 validation unseen nodes loss: 0.7515863850865051 validation all nodes loss: 0.2594873288600114
epoch 43 time used: 26  seconds  train loss: 0.17933558293221277 validation unseen nodes loss: 0.809521727910007 validation all nodes loss: 0.24977422092952867
epoch 44 time used: 26  seconds  train loss: 0.17843544844943157 validation unseen nodes loss: 1.2142193330291413 validation all nodes loss: 0.2548774780235151
epoch 45 time used: 26  seconds  train loss: 0.17870947749704535 validation unseen nodes loss: 0.38288895116235216 validation all nodes loss: 0.2605463833660975
epoch 46 time used: 26  seconds  train loss: 0.17544698383852003 validation unseen nodes loss: 0.8072839793323601 validation all nodes loss: 0.2583752424003434
epoch 47 time used: 26  seconds  train loss: 0.17696842842988025 validation unseen nodes loss: 0.46115370216160795 validation all nodes loss: 0.2617343677482466
epoch 48 time used: 26  seconds  train loss: 0.1782543949661309 validation unseen nodes loss: 1.8288075491633728 validation all nodes loss: 0.25720834578475815
epoch 49 time used: 26  seconds  train loss: 0.1756211698777665 validation unseen nodes loss: 0.39789449958035544 validation all nodes loss: 0.25449265429573337
epoch 50 time used: 26  seconds  train loss: 0.17282620179791927 validation unseen nodes loss: 0.7911394302688376 validation all nodes loss: 0.2518360372746948
epoch 51 time used: 26  seconds  train loss: 0.17399926791240736 validation unseen nodes loss: 1.0855610085925917 validation all nodes loss: 0.25864268990763783
epoch 52 time used: 26  seconds  train loss: 0.17509933162493493 validation unseen nodes loss: 1.1579365896656566 validation all nodes loss: 0.25775798148047313
epoch 53 time used: 26  seconds  train loss: 0.17246109651178376 validation unseen nodes loss: 0.9608152921356424 validation all nodes loss: 0.24797619248828748
epoch 54 time used: 26  seconds  train loss: 0.17383243955603092 validation unseen nodes loss: 0.4402201860925577 validation all nodes loss: 0.25249247430884925
epoch 55 time used: 26  seconds  train loss: 0.17852098842569664 validation unseen nodes loss: 0.31954217476566343 validation all nodes loss: 0.2519065232651077
epoch 56 time used: 26  seconds  train loss: 0.17278962743521542 validation unseen nodes loss: 0.3070291597695246 validation all nodes loss: 0.2597043624193999
epoch 57 time used: 26  seconds  train loss: 0.17207321165845801 validation unseen nodes loss: 0.3365270324606095 validation all nodes loss: 0.2573736521362388
epoch 58 time used: 26  seconds  train loss: 0.16967124459260477 validation unseen nodes loss: 0.49821823727475467 validation all nodes loss: 0.27147885155503765
epoch 59 time used: 26  seconds  train loss: 0.17040162193056013 validation unseen nodes loss: 0.4167957266577839 validation all nodes loss: 0.26066151724679626
epoch 60 time used: 26  seconds  train loss: 0.17130821444940605 validation unseen nodes loss: 0.46113458649085387 validation all nodes loss: 0.2632380765328442
epoch 61 time used: 26  seconds  train loss: 0.17025046919352957 validation unseen nodes loss: 0.37769773640771853 validation all nodes loss: 0.2648379200131354
epoch 62 time used: 26  seconds  train loss: 0.1710646828628212 validation unseen nodes loss: 0.6669339267963911 validation all nodes loss: 0.2649912402055559
epoch 63 time used: 26  seconds  train loss: 0.17009947652663887 validation unseen nodes loss: 0.45094210149597946 validation all nodes loss: 0.2581203703158093
epoch 64 time used: 26  seconds  train loss: 0.17058953274496955 validation unseen nodes loss: 0.6678229859449567 validation all nodes loss: 0.26636427161032267
epoch 65 time used: 26  seconds  train loss: 0.1707507266508254 validation unseen nodes loss: 0.35856145106092857 validation all nodes loss: 0.2506347774241092
epoch 66 time used: 26  seconds  train loss: 0.16876399589485597 validation unseen nodes loss: 0.5983860332426364 validation all nodes loss: 0.2593739512497491
epoch 67 time used: 26  seconds  train loss: 0.1709816447684561 validation unseen nodes loss: 0.42923369361536345 validation all nodes loss: 0.26748165383391137
epoch 68 time used: 26  seconds  train loss: 0.16695011812319938 validation unseen nodes loss: 0.6111413627993452 validation all nodes loss: 0.262601419791688
epoch 69 time used: 26  seconds  train loss: 0.16719547400941956 validation unseen nodes loss: 0.35162087225565947 validation all nodes loss: 0.259810344072154
epoch 70 time used: 26  seconds  train loss: 0.16756343959983674 validation unseen nodes loss: 0.3182322236221202 validation all nodes loss: 0.2556053418617179
epoch 71 time used: 26  seconds  train loss: 0.16961903192469394 validation unseen nodes loss: 0.3323724668913514 validation all nodes loss: 0.2567142959145734
epoch 72 time used: 26  seconds  train loss: 0.16642055129039032 validation unseen nodes loss: 0.33571542607606764 validation all nodes loss: 0.25979392075190577
epoch 73 time used: 26  seconds  train loss: 0.16505628436737918 validation unseen nodes loss: 0.3877574552062654 validation all nodes loss: 0.27034302427820917
epoch 74 time used: 26  seconds  train loss: 0.16486260419064686 validation unseen nodes loss: 0.4987524625332686 validation all nodes loss: 0.26573235748458085
epoch 75 time used: 26  seconds  train loss: 0.1696334547007346 validation unseen nodes loss: 0.39614065049338515 validation all nodes loss: 0.2585126413220037
epoch 76 time used: 26  seconds  train loss: 0.1733552997958959 validation unseen nodes loss: 0.42382200216724925 validation all nodes loss: 0.25842836525753465
epoch 77 time used: 26  seconds  train loss: 0.1655264369563071 validation unseen nodes loss: 0.4863778686349409 validation all nodes loss: 0.2665782268421493
epoch 78 time used: 26  seconds  train loss: 0.16407146789107127 validation unseen nodes loss: 0.3442315235277162 validation all nodes loss: 0.2601975852338067
epoch 79 time used: 26  seconds  train loss: 0.1675596136326704 validation unseen nodes loss: 0.36908129424944414 validation all nodes loss: 0.25976892860266415
epoch 80 time used: 26  seconds  train loss: 0.16360949936005692 validation unseen nodes loss: 0.3575167363490501 validation all nodes loss: 0.26803710113911733
epoch 81 time used: 26  seconds  train loss: 0.1630842588094961 validation unseen nodes loss: 0.37065610331340426 validation all nodes loss: 0.26356512249821296
epoch 82 time used: 26  seconds  train loss: 0.1642102728087611 validation unseen nodes loss: 0.34446727998935395 validation all nodes loss: 0.2604882616587799
epoch 83 time used: 26  seconds  train loss: 0.1649993895400157 validation unseen nodes loss: 1.0374419250279447 validation all nodes loss: 0.2534536320536676
epoch 84 time used: 26  seconds  train loss: 0.16435333251930745 validation unseen nodes loss: 0.3227727006821737 validation all nodes loss: 0.2647322942566698
epoch 85 time used: 26  seconds  train loss: 0.16440300107303155 validation unseen nodes loss: 0.3426912501519614 validation all nodes loss: 0.26453306435233487
epoch 86 time used: 26  seconds  train loss: 0.1626751077411878 validation unseen nodes loss: 0.4868047623042643 validation all nodes loss: 0.2732998736496389
epoch 87 time used: 26  seconds  train loss: 0.16947657503509378 validation unseen nodes loss: 0.38245236473361943 validation all nodes loss: 0.26251459318790993
epoch 88 time used: 26  seconds  train loss: 0.16328204434348403 validation unseen nodes loss: 0.5464886899064058 validation all nodes loss: 0.2653313745199329
epoch 89 time used: 26  seconds  train loss: 0.16256347607972452 validation unseen nodes loss: 0.463023234623192 validation all nodes loss: 0.26173260880647786
epoch 90 time used: 26  seconds  train loss: 0.16257088790573898 validation unseen nodes loss: 0.3535287470974191 validation all nodes loss: 0.26576640983567623
epoch 91 time used: 26  seconds  train loss: 0.16376623335937132 validation unseen nodes loss: 0.3509404020065809 validation all nodes loss: 0.2637053754251369
epoch 92 time used: 26  seconds  train loss: 0.16276439226940917 validation unseen nodes loss: 0.35527346031509177 validation all nodes loss: 0.26154257208326437
epoch 93 time used: 26  seconds  train loss: 0.16212262747630324 validation unseen nodes loss: 0.3417590808868408 validation all nodes loss: 0.2630199577164476
epoch 94 time used: 26  seconds  train loss: 0.16265929251631986 validation unseen nodes loss: 0.32820602638878094 validation all nodes loss: 0.25850139296837965
epoch 95 time used: 26  seconds  train loss: 0.16758691520959784 validation unseen nodes loss: 0.33760092000891695 validation all nodes loss: 0.2648859919422734
epoch 96 time used: 26  seconds  train loss: 0.163384119711042 validation unseen nodes loss: 0.36757408207350406 validation all nodes loss: 0.26126082917634585
epoch 97 time used: 26  seconds  train loss: 0.16095404605119656 validation unseen nodes loss: 0.3529289061483675 validation all nodes loss: 0.26505912208644145
epoch 98 time used: 26  seconds  train loss: 0.16072942972223014 validation unseen nodes loss: 0.35836687911165893 validation all nodes loss: 0.26590946068728927
epoch 99 time used: 26  seconds  train loss: 0.16129035493502344 validation unseen nodes loss: 0.3377701094724836 validation all nodes loss: 0.2630800465032132
MODEL TRAINING DURATION: 2024-10-31 09:15:28.423457 - 2024-10-31 08:30:17.562789 = 0:45:10.860668
****************************************
GraphWaveNet, train, MAE on train, 1.6004964278e-01, 0.1600496428
min_val_u_loss 0.26694095679443247
min_val_a_loss 0.21887608952330848
trainModel Ended ... Thu Oct 31 09:15:37 2024
pred_METRLA_GraphWaveNet_2410310825_972329 testing started Thu Oct 31 09:15:37 2024
Model Testing test_u Started ... Thu Oct 31 09:15:37 2024
TIMESTEP_IN, TIMESTEP_OUT 12 12
Model Infer Start ... 2024-10-31 09:15:37.458439
Model Infer End ... 2024-10-31 09:15:45.382415
MODEL INFER DURATION: 2024-10-31 09:15:45.382415 - 2024-10-31 09:15:37.458439 = 0:00:07.923976
YS.shape, YS_pred.shape, (6844, 12, 41, 1) (6844, 12, 41, 1)
YS.shape, YS_pred.shape, (6844, 12, 41) (6844, 12, 41)
****************************************
GraphWaveNet, test_u, Torch MSE, 2.8779891414e-01, 0.2877989141
all pred steps, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 115.4656829834, 10.7454957962, 5.2931051254, 12.0125658810
1 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 35.6685523987, 5.9723153114, 3.0389313698, 6.6407099366
2 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 52.7094497681, 7.2601275444, 3.6114385128, 8.0494463444
3 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 68.0625762939, 8.2500047684, 4.0931520462, 9.2893883586
4 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 84.1854629517, 9.1752634048, 4.5168008804, 10.2499544621
5 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 99.0330276489, 9.9515342712, 4.8577437401, 11.0724151134
6 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 115.2427749634, 10.7351188660, 5.3155355453, 12.0448432863
7 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 128.7304687500, 11.3459453583, 5.6769261360, 12.8388613462
8 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 139.3038940430, 11.8027067184, 5.9318962097, 13.5020315647
9 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 151.3718109131, 12.3033256531, 6.2666354179, 14.2202779651
10 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 161.0971221924, 12.6924037933, 6.5071091652, 14.8258134723
11 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 171.3577117920, 13.0903673172, 6.7575397491, 15.4287785292
12 step, GraphWaveNet, test_u, MSE, RMSE, MAE, MAPE, 178.8328857422, 13.3728408813, 6.9437747002, 15.9886851907
Model Testing Ended ... Thu Oct 31 09:15:47 2024
Model Testing test_a Started ... Thu Oct 31 09:15:47 2024
TIMESTEP_IN, TIMESTEP_OUT 12 12
Model Infer Start ... 2024-10-31 09:15:47.830598
Model Infer End ... 2024-10-31 09:15:58.168732
MODEL INFER DURATION: 2024-10-31 09:15:58.168732 - 2024-10-31 09:15:47.830598 = 0:00:10.338134
YS.shape, YS_pred.shape, (6844, 12, 207, 1) (6844, 12, 207, 1)
YS.shape, YS_pred.shape, (6844, 12, 207) (6844, 12, 207)
****************************************
GraphWaveNet, test_a, Torch MSE, 2.5231617060e-01, 0.2523161706
all pred steps, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 102.4449768066, 10.1215105057, 4.5395445824, 12.3077988625
1 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 32.0854339600, 5.6644005775, 2.7687151432, 6.8324476480
2 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 47.3664283752, 6.8823270798, 3.2184398174, 8.1772811711
3 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 60.8463554382, 7.8004074097, 3.5578234196, 9.2086791992
4 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 75.3434600830, 8.6800613403, 3.9124183655, 10.3264577687
5 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 89.1723327637, 9.4431104660, 4.2276310921, 11.2735077739
6 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 101.5984115601, 10.0796041489, 4.5076856613, 12.0572462678
7 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 113.6521606445, 10.6607770920, 4.7831869125, 13.0260571837
8 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 124.1960144043, 11.1443262100, 5.0656337738, 13.9870122075
9 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 133.5467224121, 11.5562419891, 5.2857909203, 14.6588698030
10 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 140.9235992432, 11.8711242676, 5.5060744286, 15.4036432505
11 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 151.5396575928, 12.3101444244, 5.7268972397, 16.0441592336
12 step, GraphWaveNet, test_a, MSE, RMSE, MAE, MAPE, 159.0778045654, 12.6126050949, 5.9144840240, 16.6988298297
Model Testing Ended ... Thu Oct 31 09:16:07 2024
SCRIPT DURATION 0:50:24.519080

======================================================================================
                  Resource Usage on 2024-10-31 09:16:15:
   Job Id:             127921572.gadi-pbs
   Project:            hn98
   Exit Status:        0
   Service Units:      31.27
   NCPUs Requested:    12                     NCPUs Used: 12              
                                           CPU Time Used: 00:50:00        
   Memory Requested:   8.0GB                 Memory Used: 4.5GB           
   NGPUs Requested:    1                 GPU Utilisation: 47%             
                                         GPU Memory Used: 2.32GB          
   Walltime requested: 03:00:00            Walltime Used: 00:52:07        
   JobFS requested:    100.0MB                JobFS used: 17.52KB         
======================================================================================
